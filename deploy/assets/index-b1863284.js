var vr=Object.defineProperty,wr=Object.defineProperties;var jr=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var ms=Object.prototype.hasOwnProperty,gs=Object.prototype.propertyIsEnumerable;var us=(a,t,s)=>t in a?vr(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,T=(a,t)=>{for(var s in t||(t={}))ms.call(t,s)&&us(a,s,t[s]);if(ct)for(var s of ct(t))gs.call(t,s)&&us(a,s,t[s]);return a},O=(a,t)=>wr(a,jr(t));var St=(a,t)=>{var s={};for(var r in a)ms.call(a,r)&&t.indexOf(r)<0&&(s[r]=a[r]);if(a!=null&&ct)for(var r of ct(a))t.indexOf(r)<0&&gs.call(a,r)&&(s[r]=a[r]);return s};var Nr=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports);var g=(a,t,s)=>new Promise((r,n)=>{var i=c=>{try{l(s.next(c))}catch(h){n(h)}},o=c=>{try{l(s.throw(c))}catch(h){n(h)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,o);l((s=s.apply(a,t)).next())});import{r as S,a as _r,g as kr,c as ae,R as Sr}from"./vendor-2a97f0fd.js";var Fo=Nr(W=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var Ws={exports:{}},bt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cr=S,Pr=Symbol.for("react.element"),Tr=Symbol.for("react.fragment"),Or=Object.prototype.hasOwnProperty,Er=Cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$r={key:!0,ref:!0,__self:!0,__source:!0};function Vs(a,t,s){var r,n={},i=null,o=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Or.call(t,r)&&!$r.hasOwnProperty(r)&&(n[r]=t[r]);if(a&&a.defaultProps)for(r in t=a.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:Pr,type:a,key:i,ref:o,props:n,_owner:Er.current}}bt.Fragment=Tr;bt.jsx=Vs;bt.jsxs=Vs;Ws.exports=bt;var e=Ws.exports,Wt={},fs=_r;Wt.createRoot=fs.createRoot,Wt.hydrateRoot=fs.hydrateRoot;const Ar=S.createContext(null),Ct={didCatch:!1,error:null};class Pt extends S.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Ct}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var s,r,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(s=(r=this.props).onReset)===null||s===void 0||s.call(r,{args:i,reason:"imperative-api"}),this.setState(Ct)}}componentDidCatch(t,s){var r,n;(r=(n=this.props).onError)===null||r===void 0||r.call(n,t,s)}componentDidUpdate(t,s){const{didCatch:r}=this.state,{resetKeys:n}=this.props;if(r&&s.error!==null&&Rr(t.resetKeys,n)){var i,o;(i=(o=this.props).onReset)===null||i===void 0||i.call(o,{next:n,prev:t.resetKeys,reason:"keys"}),this.setState(Ct)}}render(){const{children:t,fallbackRender:s,FallbackComponent:r,fallback:n}=this.props,{didCatch:i,error:o}=this.state;let l=t;if(i){const c={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof s=="function")l=s(c);else if(r)l=S.createElement(r,c);else if(n!==void 0)l=n;else throw o}return S.createElement(Ar.Provider,{value:{didCatch:i,error:o,resetErrorBoundary:this.resetErrorBoundary}},l)}}function Rr(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return a.length!==t.length||a.some((s,r)=>!Object.is(s,t[r]))}/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Dr=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,r)=>r?r.toUpperCase():s.toLowerCase()),ps=a=>{const t=Dr(a);return t.charAt(0).toUpperCase()+t.slice(1)},zs=(...a)=>a.filter((t,s,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===s).join(" ").trim(),Ur=a=>{for(const t in a)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=S.forwardRef((h,c)=>{var d=h,{color:a="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:n="",children:i,iconNode:o}=d,l=St(d,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return S.createElement("svg",T(T(O(T({ref:c},Lr),{width:t,height:t,stroke:a,strokeWidth:r?Number(s)*24/Number(t):s,className:zs("lucide",n)}),!i&&!Ur(l)&&{"aria-hidden":"true"}),l),[...o.map(([u,x])=>S.createElement(u,x)),...Array.isArray(i)?i:[i]])});/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=(a,t)=>{const s=S.forwardRef((o,i)=>{var l=o,{className:r}=l,n=St(l,["className"]);return S.createElement(Fr,T({ref:i,iconNode:t,className:zs(`lucide-${Ir(ps(a))}`,`lucide-${a}`,r)},n))});return s.displayName=ps(a),s};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Tt=$("archive",Mr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Br=$("arrow-right",qr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]],Vr=$("arrow-up-narrow-wide",Wr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],st=$("award",zr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Vt=$("book-open",Hr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Ot=$("calculator",Gr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],gt=$("calendar",Kr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],xs=$("chart-column",Jr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Hs=$("circle-alert",Yr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],re=$("circle-check-big",Qr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],zt=$("clock",Zr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ht=$("copy",Xr);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ta=$("crown",ea);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ie=$("dollar-sign",sa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],aa=$("download",ra);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ia=$("external-link",na);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],la=$("eye-off",oa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gs=$("eye",ca);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ha=$("file-text",da);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ma=$("funnel",ua);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],fa=$("key",ga);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],ys=$("layout-dashboard",pa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],Et=$("library",xa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],bs=$("loader-circle",ya);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],va=$("log-in",ba);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],ja=$("log-out",wa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],_a=$("message-square",Na);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=[["path",{d:"M5 12h14",key:"1ays0h"}]],Sa=$("minus",ka);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],He=$("package",Ca);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ks=$("pen",Pa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],vs=$("play",Ta);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Re=$("plus",Oa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],ws=$("receipt",Ea);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ns=$("save",$a);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ft=$("search",Aa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],is=$("settings",Ra);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Js=$("shield",Ia);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],xe=$("shopping-cart",Da);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],js=$("smartphone",Ua);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],$t=$("star",La);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ae=$("target",Fa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ze=$("trash-2",Ma);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ue=$("trending-up",qa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Gt=$("triangle-alert",Ba);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],At=$("upload",Wa);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],za=$("user-plus",Va);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ns=$("user",Ha);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ye=$("users",Ga);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pt=$("x",Ka),Ja="modulepreload",Ya=function(a){return"/"+a},_s={},at=function(t,s,r){if(!s||s.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(s.map(i=>{if(i=Ya(i),i in _s)return;_s[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=n.length-1;d>=0;d--){const u=n[d];if(u.href===i&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const h=document.createElement("link");if(h.rel=o?"stylesheet":Ja,o||(h.as="script",h.crossOrigin=""),h.href=i,document.head.appendChild(h),o)return new Promise((d,u)=>{h.addEventListener("load",d),h.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Qa=a=>{let t;return a?t=a:typeof fetch=="undefined"?t=(...s)=>at(()=>Promise.resolve().then(()=>Ke),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)};class os extends Error{constructor(t,s="FunctionsError",r){super(t),this.name=s,this.context=r}}class Za extends os{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ks extends os{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ss extends os{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Kt;(function(a){a.Any="any",a.ApNortheast1="ap-northeast-1",a.ApNortheast2="ap-northeast-2",a.ApSouth1="ap-south-1",a.ApSoutheast1="ap-southeast-1",a.ApSoutheast2="ap-southeast-2",a.CaCentral1="ca-central-1",a.EuCentral1="eu-central-1",a.EuWest1="eu-west-1",a.EuWest2="eu-west-2",a.EuWest3="eu-west-3",a.SaEast1="sa-east-1",a.UsEast1="us-east-1",a.UsWest1="us-west-1",a.UsWest2="us-west-2"})(Kt||(Kt={}));var Xa=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};class en{constructor(t,{headers:s={},customFetch:r,region:n=Kt.Any}={}){this.url=t,this.headers=s,this.region=n,this.fetch=Qa(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,s={}){var r;return Xa(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=s;let l={},{region:c}=s;c||(c=this.region);const h=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,h.searchParams.set("forceFunctionRegion",c));let d;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob!="undefined"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData!="undefined"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const u=yield this.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:d}).catch(w=>{throw new Za(w)}),x=u.headers.get("x-relay-error");if(x&&x==="true")throw new ks(u);if(!u.ok)throw new Ss(u);let b=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),m;return b==="application/json"?m=yield u.json():b==="application/octet-stream"?m=yield u.blob():b==="text/event-stream"?m=u:b==="multipart/form-data"?m=yield u.formData():m=yield u.text(),{data:m,error:null,response:u}}catch(n){return{data:null,error:n,response:n instanceof Ss||n instanceof ks?n.context:void 0}}})}}var se={},ls={},vt={},nt={},wt={},jt={},tn=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")},Ge=tn();const sn=Ge.fetch,Ys=Ge.fetch.bind(Ge),Qs=Ge.Headers,rn=Ge.Request,an=Ge.Response,Ke=Object.freeze(Object.defineProperty({__proto__:null,Headers:Qs,Request:rn,Response:an,default:Ys,fetch:sn},Symbol.toStringTag,{value:"Module"})),nn=kr(Ke);var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});let on=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Nt.default=on;var Zs=ae&&ae.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(jt,"__esModule",{value:!0});const ln=Zs(nn),cn=Zs(Nt);let dn=class{constructor(t){var s,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(s=t.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:typeof fetch=="undefined"?this.fetch=ln.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,s){return this.headers=new Headers(this.headers),this.headers.set(t,s),this}then(t,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(i=>g(this,null,function*(){var o,l,c,h;let d=null,u=null,x=null,b=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const C=yield i.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?u=C:u=JSON.parse(C))}const y=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),v=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");y&&v&&v.length>1&&(x=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,x=null,b=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const y=yield i.text();try{d=JSON.parse(y),Array.isArray(d)&&i.status===404&&(u=[],d=null,b=200,m="OK")}catch(v){i.status===404&&y===""?(b=204,m="No Content"):d={message:y}}if(d&&this.isMaybeSingle&&(!((h=d==null?void 0:d.details)===null||h===void 0)&&h.includes("0 rows"))&&(d=null,b=200,m="OK"),d&&this.shouldThrowOnError)throw new cn.default(d)}return{error:d,data:u,count:x,status:b,statusText:m}}));return this.shouldThrowOnError||(n=n.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,s)}returns(){return this}overrideTypes(){return this}};jt.default=dn;var hn=ae&&ae.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(wt,"__esModule",{value:!0});const un=hn(jt);let mn=class extends un.default{select(t){let s=!1;const r=(t!=null?t:"*").split("").map(n=>/\s/.test(n)&&!s?"":(n==='"'&&(s=!s),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:s=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${s?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:s,referencedTable:r=s}={}){const n=typeof r=="undefined"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,s,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n=="undefined"?"offset":`${n}.offset`,o=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${s-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:s=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,s?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),h=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${h}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};wt.default=mn;var gn=ae&&ae.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(nt,"__esModule",{value:!0});const fn=gn(wt);let pn=class extends fn.default{eq(t,s){return this.url.searchParams.append(t,`eq.${s}`),this}neq(t,s){return this.url.searchParams.append(t,`neq.${s}`),this}gt(t,s){return this.url.searchParams.append(t,`gt.${s}`),this}gte(t,s){return this.url.searchParams.append(t,`gte.${s}`),this}lt(t,s){return this.url.searchParams.append(t,`lt.${s}`),this}lte(t,s){return this.url.searchParams.append(t,`lte.${s}`),this}like(t,s){return this.url.searchParams.append(t,`like.${s}`),this}likeAllOf(t,s){return this.url.searchParams.append(t,`like(all).{${s.join(",")}}`),this}likeAnyOf(t,s){return this.url.searchParams.append(t,`like(any).{${s.join(",")}}`),this}ilike(t,s){return this.url.searchParams.append(t,`ilike.${s}`),this}ilikeAllOf(t,s){return this.url.searchParams.append(t,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(t,s){return this.url.searchParams.append(t,`ilike(any).{${s.join(",")}}`),this}is(t,s){return this.url.searchParams.append(t,`is.${s}`),this}in(t,s){const r=Array.from(new Set(s)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cs.{${s.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(s)}`),this}containedBy(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cd.{${s.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(s)}`),this}rangeGt(t,s){return this.url.searchParams.append(t,`sr.${s}`),this}rangeGte(t,s){return this.url.searchParams.append(t,`nxl.${s}`),this}rangeLt(t,s){return this.url.searchParams.append(t,`sl.${s}`),this}rangeLte(t,s){return this.url.searchParams.append(t,`nxr.${s}`),this}rangeAdjacent(t,s){return this.url.searchParams.append(t,`adj.${s}`),this}overlaps(t,s){return typeof s=="string"?this.url.searchParams.append(t,`ov.${s}`):this.url.searchParams.append(t,`ov.{${s.join(",")}}`),this}textSearch(t,s,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${i}fts${o}.${s}`),this}match(t){return Object.entries(t).forEach(([s,r])=>{this.url.searchParams.append(s,`eq.${r}`)}),this}not(t,s,r){return this.url.searchParams.append(t,`not.${s}.${r}`),this}or(t,{foreignTable:s,referencedTable:r=s}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,s,r){return this.url.searchParams.append(t,`${s}.${r}`),this}};nt.default=pn;var xn=ae&&ae.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(vt,"__esModule",{value:!0});const Ye=xn(nt);let yn=class{constructor(t,{headers:s={},schema:r,fetch:n}){this.url=t,this.headers=new Headers(s),this.schema=r,this.fetch=n}select(t,{head:s=!1,count:r}={}){const n=s?"HEAD":"GET";let i=!1;const o=(t!=null?t:"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new Ye.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:s,defaultToNull:r=!0}={}){var n;const i="POST";if(s&&this.headers.append("Prefer",`count=${s}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ye.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:s,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(c.length>0){const h=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new Ye.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:s}={}){var r;const n="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new Ye.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var s;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ye.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};vt.default=yn;var Xs=ae&&ae.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ls,"__esModule",{value:!0});const bn=Xs(vt),vn=Xs(nt);let wn=class er{constructor(t,{headers:s={},schema:r,fetch:n}={}){this.url=t,this.headers=new Headers(s),this.schemaName=r,this.fetch=n}from(t){const s=new URL(`${this.url}/${t}`);return new bn.default(s,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new er(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:r=!1,get:n=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let h;r||n?(l=r?"HEAD":"GET",Object.entries(s).filter(([u,x])=>x!==void 0).map(([u,x])=>[u,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([u,x])=>{c.searchParams.append(u,x)})):(l="POST",h=s);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new vn.default({method:l,url:c,headers:d,schema:this.schemaName,body:h,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};ls.default=wn;var Je=ae&&ae.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(se,"__esModule",{value:!0});se.PostgrestError=se.PostgrestBuilder=se.PostgrestTransformBuilder=se.PostgrestFilterBuilder=se.PostgrestQueryBuilder=se.PostgrestClient=void 0;const tr=Je(ls);se.PostgrestClient=tr.default;const sr=Je(vt);se.PostgrestQueryBuilder=sr.default;const rr=Je(nt);se.PostgrestFilterBuilder=rr.default;const ar=Je(wt);se.PostgrestTransformBuilder=ar.default;const nr=Je(jt);se.PostgrestBuilder=nr.default;const ir=Je(Nt);se.PostgrestError=ir.default;var jn=se.default={PostgrestClient:tr.default,PostgrestQueryBuilder:sr.default,PostgrestFilterBuilder:rr.default,PostgrestTransformBuilder:ar.default,PostgrestBuilder:nr.default,PostgrestError:ir.default};const{PostgrestClient:Nn,PostgrestQueryBuilder:Go,PostgrestFilterBuilder:Ko,PostgrestTransformBuilder:Jo,PostgrestBuilder:Yo,PostgrestError:Qo}=jn;class _n{static detectEnvironment(){var t;if(typeof WebSocket!="undefined")return{type:"native",constructor:WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocket!="undefined")return{type:"native",constructor:globalThis.WebSocket};if(typeof global!="undefined"&&typeof global.WebSocket!="undefined")return{type:"native",constructor:global.WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocketPair!="undefined"&&typeof globalThis.WebSocket=="undefined")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis!="undefined"&&globalThis.EdgeRuntime||typeof navigator!="undefined"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process!="undefined"){const s=process.versions;if(s&&s.node){const r=s.node,n=parseInt(r.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket!="undefined"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let s=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(s+=`

Suggested solution: ${t.workaround}`),new Error(s)}static createWebSocket(t,s){const r=this.getWebSocketConstructor();return new r(t,s)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch(t){return!1}}}const kn="2.15.5",Sn=`realtime-js/${kn}`,Cn="1.0.0",Jt=1e4,Pn=1e3,Tn=100;var Xe;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(Xe||(Xe={}));var J;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(J||(J={}));var oe;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(oe||(oe={}));var Yt;(function(a){a.websocket="websocket"})(Yt||(Yt={}));var $e;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})($e||($e={}));class On{constructor(){this.HEADER_LENGTH=1}decode(t,s){return t.constructor===ArrayBuffer?s(this._binaryDecode(t)):s(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const s=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,s,r)}_decodeBroadcast(t,s,r){const n=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+n));o=o+n;const c=r.decode(t.slice(o,o+i));o=o+i;const h=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:h}}}class or{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var H;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(H||(H={}));const Cs=(a,t,s={})=>{var r;const n=(r=s.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((i,o)=>(i[o]=En(o,a,t,n),i),{})},En=(a,t,s,r)=>{const n=t.find(l=>l.name===a),i=n==null?void 0:n.type,o=s[a];return i&&!r.includes(i)?lr(i,o):Qt(o)},lr=(a,t)=>{if(a.charAt(0)==="_"){const s=a.slice(1,a.length);return In(t,s)}switch(a){case H.bool:return $n(t);case H.float4:case H.float8:case H.int2:case H.int4:case H.int8:case H.numeric:case H.oid:return An(t);case H.json:case H.jsonb:return Rn(t);case H.timestamp:return Dn(t);case H.abstime:case H.date:case H.daterange:case H.int4range:case H.int8range:case H.money:case H.reltime:case H.text:case H.time:case H.timestamptz:case H.timetz:case H.tsrange:case H.tstzrange:return Qt(t);default:return Qt(t)}},Qt=a=>a,$n=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},An=a=>{if(typeof a=="string"){const t=parseFloat(a);if(!Number.isNaN(t))return t}return a},Rn=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch(t){return console.log(`JSON parse error: ${t}`),a}return a},In=(a,t)=>{if(typeof a!="string")return a;const s=a.length-1,r=a[s];if(a[0]==="{"&&r==="}"){let i;const o=a.slice(1,s);try{i=JSON.parse("["+o+"]")}catch(l){i=o?o.split(","):[]}return i.map(l=>lr(t,l))}return a},Dn=a=>typeof a=="string"?a.replace(" ","T"):a,cr=a=>{let t=a;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Rt{constructor(t,s,r={},n=Jt){this.channel=t,this.event=s,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var r;return this._hasReceived(t)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ps;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(Ps||(Ps={}));class et{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=et.syncState(this.state,n,i,o),this.pendingDiffs.forEach(c=>{this.state=et.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=et.syncDiff(this.state,n,i,o),l())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,r,n){const i=this.cloneDeep(t),o=this.transformState(s),l={},c={};return this.map(i,(h,d)=>{o[h]||(c[h]=d)}),this.map(o,(h,d)=>{const u=i[h];if(u){const x=d.map(y=>y.presence_ref),b=u.map(y=>y.presence_ref),m=d.filter(y=>b.indexOf(y.presence_ref)<0),w=u.filter(y=>x.indexOf(y.presence_ref)<0);m.length>0&&(l[h]=m),w.length>0&&(c[h]=w)}else l[h]=d}),this.syncDiff(i,{joins:l,leaves:c},r,n)}static syncDiff(t,s,r,n){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(l,c)=>{var h;const d=(h=t[l])!==null&&h!==void 0?h:[];if(t[l]=this.cloneDeep(c),d.length>0){const u=t[l].map(b=>b.presence_ref),x=d.filter(b=>u.indexOf(b.presence_ref)<0);t[l].unshift(...x)}r(l,d,c)}),this.map(o,(l,c)=>{let h=t[l];if(!h)return;const d=c.map(u=>u.presence_ref);h=h.filter(u=>d.indexOf(u.presence_ref)<0),t[l]=h,n(l,h,c),h.length===0&&delete t[l]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(r=>s(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,r)=>{const n=t[r];return"metas"in n?s[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[r]=n,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ts;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(Ts||(Ts={}));var tt;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes",a.SYSTEM="system"})(tt||(tt={}));var pe;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(pe||(pe={}));class cs{constructor(t,s={config:{}},r){this.topic=t,this.params=s,this.socket=r,this.bindings={},this.state=J.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new Rt(this,oe.join,this.params,this.timeout),this.rejoinTimer=new or(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=J.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=J.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this._on(oe.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new et(this),this.broadcastEndpointURL=cr(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,s=this.timeout){var r,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==J.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,h=(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(b=>b.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[tt.PRESENCE]&&this.bindings[tt.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,u={},x={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:h,private:c};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(b=>t==null?void 0:t(pe.CHANNEL_ERROR,b)),this._onClose(()=>t==null?void 0:t(pe.CLOSED)),this.updateJoinPayload(Object.assign({config:x},u)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",m=>g(this,[m],function*({postgres_changes:b}){var w;if(this.socket.setAuth(),b===void 0){t==null||t(pe.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,v=(w=y==null?void 0:y.length)!==null&&w!==void 0?w:0,C=[];for(let _=0;_<v;_++){const E=y[_],{filter:{event:R,schema:L,table:A,filter:ee}}=E,Q=b&&b[_];if(Q&&Q.event===R&&Q.schema===L&&Q.table===A&&Q.filter===ee)C.push(Object.assign(Object.assign({},E),{id:Q.id}));else{this.unsubscribe(),this.state=J.errored,t==null||t(pe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,t&&t(pe.SUBSCRIBED);return}})).receive("error",b=>{this.state=J.errored,t==null||t(pe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(r){return g(this,arguments,function*(t,s={}){return yield this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)})}untrack(){return g(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,s,r){return this.state===J.joined&&t===tt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,s,r)}send(r){return g(this,arguments,function*(t,s={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:l}=t,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const d=yield this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);return yield(i=d.body)===null||i===void 0?void 0:i.cancel(),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,c,h;const d=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||h===void 0)&&h.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=J.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(oe.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new Rt(this,oe.leave,{},t),r.receive("ok",()=>{s(),n("ok")}).receive("timeout",()=>{s(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=J.closed,this.bindings={}}_fetchWithTimeout(t,s,r){return g(this,null,function*(){const n=new AbortController,i=setTimeout(()=>n.abort(),r),o=yield this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(i),o})}_push(t,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Rt(this,t,s,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Tn){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(t,s,r){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,r){var n,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:h,join:d}=oe;if(r&&[l,c,h,d].indexOf(o)>=0&&r!==this._joinRef())return;let x=this._onMessage(o,s,r);if(s&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(b=>{var m,w,y;return((m=b.filter)===null||m===void 0?void 0:m.event)==="*"||((y=(w=b.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(b=>b.callback(x,r)):(i=this.bindings[o])===null||i===void 0||i.filter(b=>{var m,w,y,v,C,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in b){const E=b.id,R=(m=b.filter)===null||m===void 0?void 0:m.event;return E&&((w=s.ids)===null||w===void 0?void 0:w.includes(E))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((y=s.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const E=(C=(v=b==null?void 0:b.filter)===null||v===void 0?void 0:v.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return E==="*"||E===((_=s==null?void 0:s.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===o}).map(b=>{if(typeof x=="object"&&"ids"in x){const m=x.data,{schema:w,table:y,commit_timestamp:v,type:C,errors:_}=m;x=Object.assign(Object.assign({},{schema:w,table:y,commit_timestamp:v,eventType:C,new:{},old:{},errors:_}),this._getPayloadRecords(m))}b.callback(x,r)})}_isClosed(){return this.state===J.closed}_isJoined(){return this.state===J.joined}_isJoining(){return this.state===J.joining}_isLeaving(){return this.state===J.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,r){const n=t.toLocaleLowerCase(),i={type:n,filter:s,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(t,s){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&cs.isEqual(n.filter,s))})),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const r in t)if(t[r]!==s[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(oe.close,{},t)}_onError(t){this._on(oe.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=J.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=Cs(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=Cs(t.columns,t.old_record)),s}}const It=()=>{},dt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Un=[1e3,2e3,5e3,1e4],Ln=1e4,Fn=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Mn{constructor(t,s){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Jt,this.transport=null,this.heartbeatIntervalMs=dt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=It,this.ref=0,this.reconnectTimer=null,this.logger=It,this.conn=null,this.sendBuffer=[],this.serializer=new On,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let i;return n?i=n:typeof fetch=="undefined"?i=(...o)=>at(()=>Promise.resolve().then(()=>Ke),void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=s==null?void 0:s.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${t}/${Yt.websocket}`,this.httpEndpoint=cr(t),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=_n.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const s=t.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Cn}))}disconnect(t,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},t?this.conn.close(t,s!=null?s:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(t){return g(this,null,function*(){const s=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),s})}removeAllChannels(){return g(this,null,function*(){const t=yield Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t})}log(t,s,r){this.logger(t,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Xe.connecting:return $e.Connecting;case Xe.open:return $e.Open;case Xe.closing:return $e.Closing;default:return $e.Closed}}isConnected(){return this.connectionState()===$e.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,s={config:{}}){const r=`realtime:${t}`,n=this.getChannels().find(i=>i.topic===r);if(n)return n;{const i=new cs(`realtime:${t}`,s,this);return this.channels.push(i),i}}push(t){const{topic:s,event:r,payload:n,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${s} ${r} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return g(this,null,function*(){this._authPromise=this._performAuth(t);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return g(this,null,function*(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Pn,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},dt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")})}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(h){this.log("error","error in heartbeat callback",h)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:n,payload:i,ref:o}=s,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${n} ${l}`.trim(),i),this.channels.filter(h=>h._isMember(r)).forEach(h=>h._trigger(n,i,o)),this._triggerStateCallbacks("message",s)})}_clearTimer(t){var s;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var s;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(oe.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const r=t.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${t}${r}${n}`}_workerObjectUrl(t){let s;if(t)s=t;else{const r=new Blob([Fn],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}_setConnectionState(t,s=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=s)}_performAuth(t=null){return g(this,null,function*(){let s;t?s=t:this.accessToken?s=yield this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(r=>{const n={access_token:s,version:Sn};s&&r.updateJoinPayload(n),r.joinedOnce&&r._isJoined()&&r._push(oe.access_token,{access_token:s})}))})}_waitForAuthIfNeeded(){return g(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(t="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${t}`,s)})}_triggerStateCallbacks(t,s){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(s)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new or(()=>g(this,null,function*(){setTimeout(()=>g(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),dt.RECONNECT_DELAY)}),this.reconnectAfterMs)}_initializeOptions(t){var s,r,n,i,o,l,c,h,d;if(this.transport=(s=t==null?void 0:t.transport)!==null&&s!==void 0?s:null,this.timeout=(r=t==null?void 0:t.timeout)!==null&&r!==void 0?r:Jt,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:dt.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:It,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:u=>Un[u-1]||Ln,this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:(u,x)=>x(JSON.stringify(u)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window!="undefined"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ds extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Y(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}class qn extends ds{constructor(t,s,r){super(t),this.name="StorageApiError",this.status=s,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Zt extends ds{constructor(t,s){super(t),this.name="StorageUnknownError",this.originalError=s}}var Bn=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const dr=a=>{let t;return a?t=a:typeof fetch=="undefined"?t=(...s)=>at(()=>Promise.resolve().then(()=>Ke),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},Wn=()=>Bn(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield at(()=>Promise.resolve().then(()=>Ke),void 0)).Response:Response}),Xt=a=>{if(Array.isArray(a))return a.map(s=>Xt(s));if(typeof a=="function"||a!==Object(a))return a;const t={};return Object.entries(a).forEach(([s,r])=>{const n=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[n]=Xt(r)}),t},Vn=a=>{if(typeof a!="object"||a===null)return!1;const t=Object.getPrototypeOf(a);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)};var De=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const Dt=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),zn=(a,t,s)=>De(void 0,void 0,void 0,function*(){const r=yield Wn();a instanceof r&&!(s!=null&&s.noResolveJson)?a.json().then(n=>{const i=a.status||500,o=(n==null?void 0:n.statusCode)||i+"";t(new qn(Dt(n),i,o))}).catch(n=>{t(new Zt(Dt(n),n))}):t(new Zt(Dt(a),a))}),Hn=(a,t,s,r)=>{const n={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"||!r?n:(Vn(r)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(r)):n.body=r,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),s))};function it(a,t,s,r,n,i){return De(this,void 0,void 0,function*(){return new Promise((o,l)=>{a(s,Hn(t,r,n,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>zn(c,l,r))})})}function xt(a,t,s,r){return De(this,void 0,void 0,function*(){return it(a,"GET",t,s,r)})}function he(a,t,s,r,n){return De(this,void 0,void 0,function*(){return it(a,"POST",t,r,n,s)})}function es(a,t,s,r,n){return De(this,void 0,void 0,function*(){return it(a,"PUT",t,r,n,s)})}function Gn(a,t,s,r){return De(this,void 0,void 0,function*(){return it(a,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}function hr(a,t,s,r,n){return De(this,void 0,void 0,function*(){return it(a,"DELETE",t,r,n,s)})}var X=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const Kn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Os={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Jn{constructor(t,s={},r,n){this.url=t,this.headers=s,this.bucketId=r,this.fetch=dr(n)}uploadOrUpdate(t,s,r,n){return X(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Os),n);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob!="undefined"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData!="undefined"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const h=this._removeEmptyFolders(s),d=this._getFinalPath(h),u=yield(t=="PUT"?es:he)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:h,id:u.Id,fullPath:u.Key},error:null}}catch(i){if(Y(i))return{data:null,error:i};throw i}})}upload(t,s,r){return X(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,s,r)})}uploadToSignedUrl(t,s,r,n){return X(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",s);try{let c;const h=Object.assign({upsert:Os.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob!="undefined"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",h.cacheControl),c.append("",r)):typeof FormData!="undefined"&&r instanceof FormData?(c=r,c.append("cacheControl",h.cacheControl)):(c=r,d["cache-control"]=`max-age=${h.cacheControl}`,d["content-type"]=h.contentType);const u=yield es(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:u.Key},error:null}}catch(c){if(Y(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,s){return X(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const n=Object.assign({},this.headers);s!=null&&s.upsert&&(n["x-upsert"]="true");const i=yield he(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new ds("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}update(t,s,r){return X(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,s,r)})}move(t,s,r){return X(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}copy(t,s,r){return X(this,void 0,void 0,function*(){try{return{data:{path:(yield he(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}createSignedUrl(t,s,r){return X(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),i=yield he(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}createSignedUrls(t,s,r){return X(this,void 0,void 0,function*(){try{const n=yield he(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:t},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}download(t,s){return X(this,void 0,void 0,function*(){const n=typeof(s==null?void 0:s.transform)!="undefined"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield xt(this.fetch,`${this.url}/${n}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Y(l))return{data:null,error:l};throw l}})}info(t){return X(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{const r=yield xt(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Xt(r),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}exists(t){return X(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{return yield Gn(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Y(r)&&r instanceof Zt){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,s){const r=this._getFinalPath(t),n=[],i=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&n.push(i);const l=typeof(s==null?void 0:s.transform)!="undefined"?"render/image":"object",c=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});c!==""&&n.push(c);let h=n.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${h}`)}}}remove(t){return X(this,void 0,void 0,function*(){try{return{data:yield hr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}list(t,s,r){return X(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Kn),s),{prefix:t||""});return{data:yield he(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}})}listV2(t,s){return X(this,void 0,void 0,function*(){try{const r=Object.assign({},t);return{data:yield he(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer!="undefined"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const s=[];return t.width&&s.push(`width=${t.width}`),t.height&&s.push(`height=${t.height}`),t.resize&&s.push(`resize=${t.resize}`),t.format&&s.push(`format=${t.format}`),t.quality&&s.push(`quality=${t.quality}`),s.join("&")}}const Yn="2.11.1",Qn={"X-Client-Info":`storage-js/${Yn}`};var Fe=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};class Zn{constructor(t,s={},r,n){const i=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Qn),s),this.fetch=dr(r)}listBuckets(){return Fe(this,void 0,void 0,function*(){try{return{data:yield xt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}})}getBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield xt(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}createBucket(t,s={public:!1}){return Fe(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}updateBucket(t,s){return Fe(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}deleteBucket(t){return Fe(this,void 0,void 0,function*(){try{return{data:yield hr(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}})}}class Xn extends Zn{constructor(t,s={},r,n){super(t,s,r,n)}from(t){return new Jn(this.url,this.headers,t,this.fetch)}}const ei="2.57.2";let Qe="";typeof Deno!="undefined"?Qe="deno":typeof document!="undefined"?Qe="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?Qe="react-native":Qe="node";const ti={"X-Client-Info":`supabase-js-${Qe}/${ei}`},si={headers:ti},ri={schema:"public"},ai={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ni={};var ii=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const oi=a=>{let t;return a?t=a:typeof fetch=="undefined"?t=Ys:t=fetch,(...s)=>t(...s)},li=()=>typeof Headers=="undefined"?Qs:Headers,ci=(a,t,s)=>{const r=oi(s),n=li();return(i,o)=>ii(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:a;let h=new n(o==null?void 0:o.headers);return h.has("apikey")||h.set("apikey",a),h.has("Authorization")||h.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:h}))})};var di=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};function hi(a){return a.endsWith("/")?a:a+"/"}function ui(a,t){var s,r;const{db:n,auth:i,realtime:o,global:l}=a,{db:c,auth:h,realtime:d,global:u}=t,x={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},h),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},u),l),{headers:Object.assign(Object.assign({},(s=u==null?void 0:u.headers)!==null&&s!==void 0?s:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>di(this,void 0,void 0,function*(){return""})};return a.accessToken?x.accessToken=a.accessToken:delete x.accessToken,x}const ur="2.71.1",Ve=30*1e3,ts=3,Ut=ts*Ve,mi="http://localhost:9999",gi="supabase.auth.token",fi={"X-Client-Info":`gotrue-js/${ur}`},ss="X-Supabase-Api-Version",mr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},pi=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,xi=10*60*1e3;class hs extends Error{constructor(t,s,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function I(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class yi extends hs{constructor(t,s,r){super(t,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function bi(a){return I(a)&&a.name==="AuthApiError"}class gr extends hs{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class _e extends hs{constructor(t,s,r,n){super(t,r,n),this.name=s,this.status=r}}class je extends _e{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function vi(a){return I(a)&&a.name==="AuthSessionMissingError"}class ht extends _e{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ut extends _e{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class mt extends _e{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wi(a){return I(a)&&a.name==="AuthImplicitGrantRedirectError"}class Es extends _e{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rs extends _e{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function Lt(a){return I(a)&&a.name==="AuthRetryableFetchError"}class $s extends _e{constructor(t,s,r){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}class as extends _e{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),As=` 	
\r=`.split(""),ji=(()=>{const a=new Array(128);for(let t=0;t<a.length;t+=1)a[t]=-1;for(let t=0;t<As.length;t+=1)a[As[t].charCodeAt(0)]=-2;for(let t=0;t<yt.length;t+=1)a[yt[t].charCodeAt(0)]=t;return a})();function Rs(a,t,s){if(a!==null)for(t.queue=t.queue<<8|a,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;s(yt[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;s(yt[r]),t.queuedBits-=6}}function fr(a,t,s){const r=ji[a];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}}function Is(a){const t=[],s=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{ki(o,r,s)};for(let o=0;o<a.length;o+=1)fr(a.charCodeAt(o),n,i);return t.join("")}function Ni(a,t){if(a<=127){t(a);return}else if(a<=2047){t(192|a>>6),t(128|a&63);return}else if(a<=65535){t(224|a>>12),t(128|a>>6&63),t(128|a&63);return}else if(a<=1114111){t(240|a>>18),t(128|a>>12&63),t(128|a>>6&63),t(128|a&63);return}throw new Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}function _i(a,t){for(let s=0;s<a.length;s+=1){let r=a.charCodeAt(s);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(a.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}Ni(r,t)}}function ki(a,t,s){if(t.utf8seq===0){if(a<=127){s(a);return}for(let r=1;r<6;r+=1)if(!(a>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=a&31;else if(t.utf8seq===3)t.codepoint=a&15;else if(t.utf8seq===4)t.codepoint=a&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(a<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|a&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function Si(a){const t=[],s={queue:0,queuedBits:0},r=n=>{t.push(n)};for(let n=0;n<a.length;n+=1)fr(a.charCodeAt(n),s,r);return new Uint8Array(t)}function Ci(a){const t=[];return _i(a,s=>t.push(s)),new Uint8Array(t)}function Pi(a){const t=[],s={queue:0,queuedBits:0},r=n=>{t.push(n)};return a.forEach(n=>Rs(n,s,r)),Rs(null,s,r),t.join("")}function Ti(a){return Math.round(Date.now()/1e3)+a}function Oi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=Math.random()*16|0;return(a=="x"?t:t&3|8).toString(16)})}const ie=()=>typeof window!="undefined"&&typeof document!="undefined",Pe={tested:!1,writable:!1},pr=()=>{if(!ie())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch(t){return!1}if(Pe.tested)return Pe.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),Pe.tested=!0,Pe.writable=!0}catch(t){Pe.tested=!0,Pe.writable=!1}return Pe.writable};function Ei(a){const t={},s=new URL(a);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,i)=>{t[i]=n})}catch(r){}return s.searchParams.forEach((r,n)=>{t[n]=r}),t}const xr=a=>{let t;return a?t=a:typeof fetch=="undefined"?t=(...s)=>at(()=>Promise.resolve().then(()=>Ke),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},$i=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",ze=(a,t,s)=>g(W,null,function*(){yield a.setItem(t,JSON.stringify(s))}),Te=(a,t)=>g(W,null,function*(){const s=yield a.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}}),we=(a,t)=>g(W,null,function*(){yield a.removeItem(t)});class _t{constructor(){this.promise=new _t.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}_t.promiseConstructor=Promise;function Ft(a){const t=a.split(".");if(t.length!==3)throw new as("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!pi.test(t[r]))throw new as("JWT not in base64url format");return{header:JSON.parse(Is(t[0])),payload:JSON.parse(Is(t[1])),signature:Si(t[2]),raw:{header:t[0],payload:t[1]}}}function Ai(a){return g(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),a)})})}function Ri(a,t){return new Promise((r,n)=>{g(this,null,function*(){for(let i=0;i<1/0;i++)try{const o=yield a(i);if(!t(i,null,o)){r(o);return}}catch(o){if(!t(i,o)){n(o);return}}})})}function Ii(a){return("0"+a.toString(16)).substr(-2)}function Di(){const t=new Uint32Array(56);if(typeof crypto=="undefined"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let n="";for(let i=0;i<56;i++)n+=s.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(t),Array.from(t,Ii).join("")}function Ui(a){return g(this,null,function*(){const s=new TextEncoder().encode(a),r=yield crypto.subtle.digest("SHA-256",s),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")})}function Li(a){return g(this,null,function*(){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const s=yield Ui(a);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function Me(a,t,s=!1){return g(this,null,function*(){const r=Di();let n=r;s&&(n+="/PASSWORD_RECOVERY"),yield ze(a,`${t}-code-verifier`,n);const i=yield Li(r);return[i,r===i?"plain":"s256"]})}const Fi=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Mi(a){const t=a.headers.get(ss);if(!t||!t.match(Fi))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(s){return null}}function qi(a){if(!a)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(a<=t)throw new Error("JWT has expired")}function Bi(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Wi=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qe(a){if(!Wi.test(a))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Mt(){const a={};return new Proxy(a,{get:(t,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ds(a){return JSON.parse(JSON.stringify(a))}var Vi=globalThis&&globalThis.__rest||function(a,t){var s={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(s[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(a);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(a,r[n])&&(s[r[n]]=a[r[n]]);return s};const Ee=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),zi=[502,503,504];function Us(a){return g(this,null,function*(){var t;if(!$i(a))throw new rs(Ee(a),0);if(zi.includes(a.status))throw new rs(Ee(a),a.status);let s;try{s=yield a.json()}catch(i){throw new gr(Ee(i),i)}let r;const n=Mi(a);if(n&&n.getTime()>=mr["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new $s(Ee(s),a.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new je}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new $s(Ee(s),a.status,s.weak_password.reasons);throw new yi(Ee(s),a.status||500,r)})}const Hi=(a,t,s,r)=>{const n={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))};function F(a,t,s,r){return g(this,null,function*(){var n;const i=Object.assign({},r==null?void 0:r.headers);i[ss]||(i[ss]=mr["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=yield Gi(a,t,s+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}})}function Gi(a,t,s,r,n,i){return g(this,null,function*(){const o=Hi(t,r,n,i);let l;try{l=yield a(s,Object.assign({},o))}catch(c){throw console.error(c),new rs(Ee(c),0)}if(l.ok||(yield Us(l)),r!=null&&r.noResolveJson)return l;try{return yield l.json()}catch(c){yield Us(c)}})}function fe(a){var t;let s=null;Qi(a)&&(s=Object.assign({},a),a.expires_at||(s.expires_at=Ti(a.expires_in)));const r=(t=a.user)!==null&&t!==void 0?t:a;return{data:{session:s,user:r},error:null}}function Ls(a){const t=fe(a);return!t.error&&a.weak_password&&typeof a.weak_password=="object"&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&typeof a.weak_password.message=="string"&&a.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(t.data.weak_password=a.weak_password),t}function Ne(a){var t;return{data:{user:(t=a.user)!==null&&t!==void 0?t:a},error:null}}function Ki(a){return{data:a,error:null}}function Ji(a){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=a,o=Vi(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Yi(a){return a}function Qi(a){return a.access_token&&a.refresh_token&&a.expires_in}const qt=["global","local","others"];var Zi=globalThis&&globalThis.__rest||function(a,t){var s={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(s[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(a);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(a,r[n])&&(s[r[n]]=a[r[n]]);return s};class Xi{constructor({url:t="",headers:s={},fetch:r}){this.url=t,this.headers=s,this.fetch=xr(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(r){return g(this,arguments,function*(t,s=qt[0]){if(qt.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${qt.join(", ")}`);try{return yield F(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(I(n))return{data:null,error:n};throw n}})}inviteUserByEmail(r){return g(this,arguments,function*(t,s={}){try{return yield F(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Ne})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}})}generateLink(t){return g(this,null,function*(){try{const{options:s}=t,r=Zi(t,["options"]),n=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),yield F(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Ji,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(I(s))return{data:{properties:null,user:null},error:s};throw s}})}createUser(t){return g(this,null,function*(){try{return yield F(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ne})}catch(s){if(I(s))return{data:{user:null},error:s};throw s}})}listUsers(t){return g(this,null,function*(){var s,r,n,i,o,l,c;try{const h={nextPage:null,lastPage:0,total:0},d=yield F(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Yi});if(d.error)throw d.error;const u=yield d.json(),x=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,b=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return b.length>0&&(b.forEach(m=>{const w=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(m.split(";")[1].split("=")[1]);h[`${y}Page`]=w}),h.total=parseInt(x)),{data:Object.assign(Object.assign({},u),h),error:null}}catch(h){if(I(h))return{data:{users:[]},error:h};throw h}})}getUserById(t){return g(this,null,function*(){qe(t);try{return yield F(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ne})}catch(s){if(I(s))return{data:{user:null},error:s};throw s}})}updateUserById(t,s){return g(this,null,function*(){qe(t);try{return yield F(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:Ne})}catch(r){if(I(r))return{data:{user:null},error:r};throw r}})}deleteUser(t,s=!1){return g(this,null,function*(){qe(t);try{return yield F(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:Ne})}catch(r){if(I(r))return{data:{user:null},error:r};throw r}})}_listFactors(t){return g(this,null,function*(){qe(t.userId);try{const{data:s,error:r}=yield F(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:r}}catch(s){if(I(s))return{data:null,error:s};throw s}})}_deleteFactor(t){return g(this,null,function*(){qe(t.userId),qe(t.id);try{return{data:yield F(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(I(s))return{data:null,error:s};throw s}})}}function Fs(a={}){return{getItem:t=>a[t]||null,setItem:(t,s)=>{a[t]=s},removeItem:t=>{delete a[t]}}}function eo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(a){typeof self!="undefined"&&(self.globalThis=self)}}const Be={debug:!!(globalThis&&pr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class yr extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class to extends yr{}function so(a,t,s){return g(this,null,function*(){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",a,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Be.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",a)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(a,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},n=>g(this,null,function*(){if(n){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",a,n.name);try{return yield s()}finally{Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",a,n.name)}}else{if(t===0)throw Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",a),new to(`Acquiring an exclusive Navigator LockManager lock "${a}" immediately failed`);if(Be.debug)try{const i=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield s()}})))})}eo();const ro={url:mi,storageKey:gi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:fi,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function Ms(a,t,s){return g(this,null,function*(){return yield s()})}const We={};class rt{constructor(t){var s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=rt.nextInstanceID,rt.nextInstanceID+=1,this.instanceID>0&&ie()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},ro),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Xi({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=xr(n.fetch),this.lock=n.lock||Ms,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ie()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=so:this.lock=Ms,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:pr()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Fs(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Fs(this.memoryStorage)),ie()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",i=>g(this,null,function*(){this._debug("received broadcast notification from other tab or client",i),yield this._notifyAllSubscribers(i.data.event,i.data.session,!1)}))}this.initialize()}get jwks(){var t,s;return(s=(t=We[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(t){We[this.storageKey]=Object.assign(Object.assign({},We[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,s;return(s=(t=We[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){We[this.storageKey]=Object.assign(Object.assign({},We[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ur}) ${new Date().toISOString()}`,...t),this}initialize(){return g(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=(()=>g(this,null,function*(){return yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._initialize()}))}))(),yield this.initializePromise)})}_initialize(){return g(this,null,function*(){var t;try{const s=Ei(window.location.href);let r="none";if(this._isImplicitGrantCallback(s)?r="implicit":(yield this._isPKCECallback(s))&&(r="pkce"),ie()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=yield this._getSessionFromURL(s,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),wi(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return yield this._removeSession(),{error:i}}const{session:o,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),yield this._saveSession(o),setTimeout(()=>g(this,null,function*(){l==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",o):yield this._notifyAllSubscribers("SIGNED_IN",o)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(s){return I(s)?{error:s}:{error:new gr("Unexpected error during initialization",s)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(t){return g(this,null,function*(){var s,r,n;try{const i=yield F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:fe}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,h=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(i){if(I(i))return{data:{user:null,session:null},error:i};throw i}})}signUp(t){return g(this,null,function*(){var s,r,n;try{let i;if("email"in t){const{email:d,password:u,options:x}=t;let b=null,m=null;this.flowType==="pkce"&&([b,m]=yield Me(this.storage,this.storageKey)),i=yield F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:d,password:u,data:(s=x==null?void 0:x.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:b,code_challenge_method:m},xform:fe})}else if("phone"in t){const{phone:d,password:u,options:x}=t;i=yield F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:u,data:(r=x==null?void 0:x.data)!==null&&r!==void 0?r:{},channel:(n=x==null?void 0:x.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:fe})}else throw new ut("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,h=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(i){if(I(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithPassword(t){return g(this,null,function*(){try{let s;if("email"in t){const{email:i,password:o,options:l}=t;s=yield F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ls})}else if("phone"in t){const{phone:i,password:o,options:l}=t;s=yield F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ls})}else throw new ut("You must provide either an email or phone number and a password");const{data:r,error:n}=s;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ht}:(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(s){if(I(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithOAuth(t){return g(this,null,function*(){var s,r,n,i;return yield this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})})}exchangeCodeForSession(t){return g(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>g(this,null,function*(){return this._exchangeCodeForSession(t)}))})}signInWithWeb3(t){return g(this,null,function*(){const{chain:s}=t;if(s==="solana")return yield this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)})}signInWithSolana(t){return g(this,null,function*(){var s,r,n,i,o,l,c,h,d,u,x,b;let m,w;if("message"in t)m=t.message,w=t.signature;else{const{chain:y,wallet:v,statement:C,options:_}=t;let E;if(ie())if(typeof v=="object")E=v;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))E=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=v}const R=new URL((s=_==null?void 0:_.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in E&&E.signIn){const L=yield E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),C?{statement:C}:null));let A;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")A=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)A=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)m=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),w=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${R.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(n=(r=_==null?void 0:_.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((h=_==null?void 0:_.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((u=(d=_==null?void 0:_.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||u===void 0)&&u.length?["Resources",..._.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const L=yield E.signMessage(new TextEncoder().encode(m),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=L}}try{const{data:y,error:v}=yield F(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Pi(w)},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:fe});if(v)throw v;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new ht}:(y.session&&(yield this._saveSession(y.session),yield this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:v})}catch(y){if(I(y))return{data:{user:null,session:null},error:y};throw y}})}_exchangeCodeForSession(t){return g(this,null,function*(){const s=yield Te(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(s!=null?s:"").split("/");try{const{data:i,error:o}=yield F(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:fe});if(yield we(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ht}:(i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n!=null?n:null}),error:o})}catch(i){if(I(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}})}signInWithIdToken(t){return g(this,null,function*(){try{const{options:s,provider:r,token:n,access_token:i,nonce:o}=t,l=yield F(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:fe}),{data:c,error:h}=l;return h?{data:{user:null,session:null},error:h}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new ht}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:h})}catch(s){if(I(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithOtp(t){return g(this,null,function*(){var s,r,n,i,o;try{if("email"in t){const{email:l,options:c}=t;let h=null,d=null;this.flowType==="pkce"&&([h,d]=yield Me(this.storage,this.storageKey));const{error:u}=yield F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:h,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in t){const{phone:l,options:c}=t,{data:h,error:d}=yield F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:d}}throw new ut("You must provide either an email or phone number.")}catch(l){if(I(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(t){return g(this,null,function*(){var s,r;try{let n,i;"options"in t&&(n=(s=t.options)===null||s===void 0?void 0:s.redirectTo,i=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=yield F(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:fe});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,h=o.user;return c!=null&&c.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(n){if(I(n))return{data:{user:null,session:null},error:n};throw n}})}signInWithSSO(t){return g(this,null,function*(){var s,r,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=yield Me(this.storage,this.storageKey)),yield F(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Ki})}catch(i){if(I(i))return{data:null,error:i};throw i}})}reauthenticate(){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return g(this,null,function*(){try{return yield this._useSession(t=>g(this,null,function*(){const{data:{session:s},error:r}=t;if(r)throw r;if(!s)throw new je;const{error:n}=yield F(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}}))}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return g(this,null,function*(){try{const s=`${this.url}/resend`;if("email"in t){const{email:r,type:n,options:i}=t,{error:o}=yield F(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:n,options:i}=t,{data:o,error:l}=yield F(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new ut("You must provide either an email or phone number and a type")}catch(s){if(I(s))return{data:{user:null,session:null},error:s};throw s}})}getSession(){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return this._useSession(s=>g(this,null,function*(){return s}))}))})}_acquireLock(t,s){return g(this,null,function*(){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(()=>g(this,null,function*(){return yield r,yield s()}))();return this.pendingInLock.push((()=>g(this,null,function*(){try{yield n}catch(i){}}))()),n}return yield this.lock(`lock:${this.storageKey}`,t,()=>g(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((()=>g(this,null,function*(){try{yield r}catch(n){}}))()),yield r;this.pendingInLock.length;){const n=[...this.pendingInLock];yield Promise.all(n),this.pendingInLock.splice(0,n.length)}return yield r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(t){return g(this,null,function*(){this._debug("#_useSession","begin");try{const s=yield this.__loadSession();return yield t(s)}finally{this._debug("#_useSession","end")}})}__loadSession(){return g(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=yield Te(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Ut:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const o=yield Te(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Mt()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,h,d)=>(!o&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,h,d))})}return{data:{session:t},error:null}}const{session:n,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(t){return g(this,null,function*(){return t?yield this._getUser(t):(yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._getUser()})))})}_getUser(t){return g(this,null,function*(){try{return t?yield F(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ne}):yield this._useSession(s=>g(this,null,function*(){var r,n,i;const{data:o,error:l}=s;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new je}:yield F(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Ne})}))}catch(s){if(I(s))return vi(s)&&(yield this._removeSession(),yield we(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}})}updateUser(r){return g(this,arguments,function*(t,s={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._updateUser(t,s)}))})}_updateUser(r){return g(this,arguments,function*(t,s={}){try{return yield this._useSession(n=>g(this,null,function*(){const{data:i,error:o}=n;if(o)throw o;if(!i.session)throw new je;const l=i.session;let c=null,h=null;this.flowType==="pkce"&&t.email!=null&&([c,h]=yield Me(this.storage,this.storageKey));const{data:d,error:u}=yield F(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:h}),jwt:l.access_token,xform:Ne});if(u)throw u;return l.user=d.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(n){if(I(n))return{data:{user:null},error:n};throw n}})}setSession(t){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._setSession(t)}))})}_setSession(t){return g(this,null,function*(){try{if(!t.access_token||!t.refresh_token)throw new je;const s=Date.now()/1e3;let r=s,n=!0,i=null;const{payload:o}=Ft(t.access_token);if(o.exp&&(r=o.exp,n=r<=s),n){const{session:l,error:c}=yield this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=yield this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-s,expires_at:r},yield this._saveSession(i),yield this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(s){if(I(s))return{data:{session:null,user:null},error:s};throw s}})}refreshSession(t){return g(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._refreshSession(t)}))})}_refreshSession(t){return g(this,null,function*(){try{return yield this._useSession(s=>g(this,null,function*(){var r;if(!t){const{data:o,error:l}=s;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new je;const{session:n,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(s){if(I(s))return{data:{user:null,session:null},error:s};throw s}})}_getSessionFromURL(t,s){return g(this,null,function*(){try{if(!ie())throw new mt("No browser detected.");if(t.error||t.error_description||t.error_code)throw new mt(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Es("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new mt("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Es("No code detected.");const{data:C,error:_}=yield this._exchangeCodeForSession(t.code);if(_)throw _;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:h}=t;if(!i||!l||!o||!h)throw new mt("No session defined in URL");const d=Math.round(Date.now()/1e3),u=parseInt(l);let x=d+u;c&&(x=parseInt(c));const b=x-d;b*1e3<=Ve&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${u}s`);const m=x-u;d-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,x,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,x,d);const{data:w,error:y}=yield this._getUser(i);if(y)throw y;const v={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:x,refresh_token:o,token_type:h,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(r){if(I(r))return{data:{session:null,redirectType:null},error:r};throw r}})}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}_isPKCECallback(t){return g(this,null,function*(){const s=yield Te(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)})}signOut(){return g(this,arguments,function*(t={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){return yield this._signOut(t)}))})}_signOut(){return g(this,arguments,function*({scope:t}={scope:"global"}){return yield this._useSession(s=>g(this,null,function*(){var r;const{data:n,error:i}=s;if(i)return{error:i};const o=(r=n.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=yield this.admin.signOut(o,t);if(l&&!(bi(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(yield this._removeSession(),yield we(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(t){const s=Oi(),r={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),g(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){this._emitInitialSession(s)}))}),{data:{subscription:r}}}_emitInitialSession(t){return g(this,null,function*(){return yield this._useSession(s=>g(this,null,function*(){var r,n;try{const{data:{session:i},error:o}=s;if(o)throw o;yield(r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){yield(n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}}))})}resetPasswordForEmail(r){return g(this,arguments,function*(t,s={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=yield Me(this.storage,this.storageKey,!0));try{return yield F(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(o){if(I(o))return{data:null,error:o};throw o}})}getUserIdentities(){return g(this,null,function*(){var t;try{const{data:s,error:r}=yield this.getUser();if(r)throw r;return{data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(s){if(I(s))return{data:null,error:s};throw s}})}linkIdentity(t){return g(this,null,function*(){var s;try{const{data:r,error:n}=yield this._useSession(i=>g(this,null,function*(){var o,l,c,h,d;const{data:u,error:x}=i;if(x)throw x;const b=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield F(this.fetch,"GET",b,{headers:this.headers,jwt:(d=(h=u.session)===null||h===void 0?void 0:h.access_token)!==null&&d!==void 0?d:void 0})}));if(n)throw n;return ie()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(I(r))return{data:{provider:t.provider,url:null},error:r};throw r}})}unlinkIdentity(t){return g(this,null,function*(){try{return yield this._useSession(s=>g(this,null,function*(){var r,n;const{data:i,error:o}=s;if(o)throw o;return yield F(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})}))}catch(s){if(I(s))return{data:null,error:s};throw s}})}_refreshAccessToken(t){return g(this,null,function*(){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return yield Ri(n=>g(this,null,function*(){return n>0&&(yield Ai(200*Math.pow(2,n-1))),this._debug(s,"refreshing attempt",n),yield F(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:fe})}),(n,i)=>{const o=200*Math.pow(2,n);return i&&Lt(i)&&Date.now()+o-r<Ve})}catch(r){if(this._debug(s,"error",r),I(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(s,"end")}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,s){return g(this,null,function*(){const r=yield this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",r),ie()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}})}_recoverAndRefresh(){return g(this,null,function*(){var t,s;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=yield Te(this.storage,this.storageKey);if(n&&this.userStorage){let o=yield Te(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},yield ze(this.userStorage,this.storageKey+"-user",o)),n.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Mt()}else if(n&&!n.user&&!n.user){const o=yield Te(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,yield we(this.storage,this.storageKey+"-user"),yield ze(this.storage,this.storageKey,n)):n.user=Mt()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&(yield this._removeSession());return}const i=((s=n.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<Ut;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Ut}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=yield this._callRefreshToken(n.refresh_token);o&&(console.error(o),Lt(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),yield this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=yield this._getUser(n.access_token);!l&&(o!=null&&o.user)?(n.user=o.user,yield this._saveSession(n),yield this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else yield this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}})}_callRefreshToken(t){return g(this,null,function*(){var s,r;if(!t)throw new je;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new _t;const{data:i,error:o}=yield this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new je;yield this._saveSession(i.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(n,"error",i),I(i)){const o={session:null,error:i};return Lt(i)||(yield this._removeSession()),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}})}_notifyAllSubscribers(t,s,r=!0){return g(this,null,function*(){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(l=>g(this,null,function*(){try{yield l.callback(t,s)}catch(c){i.push(c)}}));if(yield Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(n,"end")}})}_saveSession(t){return g(this,null,function*(){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const s=Object.assign({},t),r=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&s.user&&(yield ze(this.userStorage,this.storageKey+"-user",{user:s.user}));const n=Object.assign({},s);delete n.user;const i=Ds(n);yield ze(this.storage,this.storageKey,i)}else{const n=Ds(s);yield ze(this.storage,this.storageKey,n)}})}_removeSession(){return g(this,null,function*(){this._debug("#_removeSession()"),yield we(this.storage,this.storageKey),yield we(this.storage,this.storageKey+"-code-verifier"),yield we(this.storage,this.storageKey+"-user"),this.userStorage&&(yield we(this.userStorage,this.storageKey+"-user")),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ie()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}_startAutoRefresh(){return g(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ve);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(()=>g(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return g(this,null,function*(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return g(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return g(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return g(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>g(this,null,function*(){try{const t=Date.now();try{return yield this._useSession(s=>g(this,null,function*(){const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-t)/Ve);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ve}ms, refresh threshold is ${ts} ticks`),n<=ts&&(yield this._callRefreshToken(r.refresh_token))}))}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(t.isAcquireTimeout||t instanceof yr)this._debug("auto refresh token tick lock not available");else throw t}})}_handleVisibilityChange(){return g(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!ie()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>g(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return g(this,null,function*(){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(yield this.initializePromise,yield this._acquireLock(-1,()=>g(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,s,r){return g(this,null,function*(){const n=[`provider=${encodeURIComponent(s)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=yield Me(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${n.join("&")}`})}_unenroll(t){return g(this,null,function*(){try{return yield this._useSession(s=>g(this,null,function*(){var r;const{data:n,error:i}=s;return i?{data:null,error:i}:yield F(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})}))}catch(s){if(I(s))return{data:null,error:s};throw s}})}_enroll(t){return g(this,null,function*(){try{return yield this._useSession(s=>g(this,null,function*(){var r,n;const{data:i,error:o}=s;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:h}=yield F(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return h?{data:null,error:h}:(t.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(s){if(I(s))return{data:null,error:s};throw s}})}_verify(t){return g(this,null,function*(){return this._acquireLock(-1,()=>g(this,null,function*(){try{return yield this._useSession(s=>g(this,null,function*(){var r;const{data:n,error:i}=s;if(i)return{data:null,error:i};const{data:o,error:l}=yield F(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})}))}catch(s){if(I(s))return{data:null,error:s};throw s}}))})}_challenge(t){return g(this,null,function*(){return this._acquireLock(-1,()=>g(this,null,function*(){try{return yield this._useSession(s=>g(this,null,function*(){var r;const{data:n,error:i}=s;return i?{data:null,error:i}:yield F(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})}))}catch(s){if(I(s))return{data:null,error:s};throw s}}))})}_challengeAndVerify(t){return g(this,null,function*(){const{data:s,error:r}=yield this._challenge({factorId:t.factorId});return r?{data:null,error:r}:yield this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})})}_listFactors(){return g(this,null,function*(){const{data:{user:t},error:s}=yield this.getUser();if(s)return{data:null,error:s};const r=(t==null?void 0:t.factors)||[],n=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}})}_getAuthenticatorAssuranceLevel(){return g(this,null,function*(){return this._acquireLock(-1,()=>g(this,null,function*(){return yield this._useSession(t=>g(this,null,function*(){var s,r;const{data:{session:n},error:i}=t;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ft(n.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(s=n.user.factors)===null||s===void 0?void 0:s.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}))})}fetchJwk(r){return g(this,arguments,function*(t,s={keys:[]}){let n=s.keys.find(c=>c.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(c=>c.kid===t),n&&this.jwks_cached_at+xi>i)return n;const{data:o,error:l}=yield F(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=i,n=o.keys.find(c=>c.kid===t),!n)?null:n})}getClaims(r){return g(this,arguments,function*(t,s={}){try{let n=t;if(!n){const{data:m,error:w}=yield this.getSession();if(w||!m.session)return{data:null,error:w};n=m.session.access_token}const{header:i,payload:o,signature:l,raw:{header:c,payload:h}}=Ft(n);s!=null&&s.allowExpired||qi(o.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:yield this.fetchJwk(i.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!d){const{error:m}=yield this.getUser(n);if(m)throw m;return{data:{claims:o,header:i,signature:l},error:null}}const u=Bi(i.alg),x=yield crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!(yield crypto.subtle.verify(u,x,l,Ci(`${c}.${h}`))))throw new as("Invalid JWT signature");return{data:{claims:o,header:i,signature:l},error:null}}catch(n){if(I(n))return{data:null,error:n};throw n}})}}rt.nextInstanceID=0;const ao=rt;class no extends ao{constructor(t){super(t)}}var io=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};class oo{constructor(t,s,r){var n,i,o;if(this.supabaseUrl=t,this.supabaseKey=s,!t)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const l=hi(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const h=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:ri,realtime:ni,auth:Object.assign(Object.assign({},ai),{storageKey:h}),global:si},u=ui(r!=null?r:{},d);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(x,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=ci(s,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Nn(new URL("rest/v1",c).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Xn(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new en(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,s={},r={}){return this.rest.rpc(t,s,r)}channel(t,s={config:{}}){return this.realtime.channel(t,s)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,s;return io(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(s=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:o,flowType:l,lock:c,debug:h},d,u){const x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new no({url:this.authUrl.href,headers:Object.assign(Object.assign({},x),d),storageKey:o,autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:n,userStorage:i,flowType:l,lock:c,debug:h,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Mn(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,r)=>{this._handleTokenChanged(s,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,s,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const lo=(a,t,s)=>new oo(a,t,s);function co(){if(typeof window!="undefined"||typeof process=="undefined")return!1;const a=process.version;if(a==null)return!1;const t=a.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}co()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ho="https://iuwmububntckwrfuiqtx.supabase.co",uo="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml1d211YnVibnRja3dyZnVpcXR4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4NzYxNDUsImV4cCI6MjA3MTQ1MjE0NX0.mimBgOJyl41tTrWrj9d1uF33GqXeYTP1DN0_7rKHoWc",V=lo(ho,uo),mo=(a,t,s)=>g(W,null,function*(){const{data:r,error:n}=yield V.auth.signUp({email:a,password:t,options:{data:{full_name:s},emailRedirectTo:`${window.location.origin}?confirmed=true`}});return{data:r,error:n}}),qs=(a,t)=>g(W,null,function*(){const{data:s,error:r}=yield V.auth.signInWithPassword({email:a,password:t});return{data:s,error:r}}),go=()=>g(W,null,function*(){const{data:{user:a},error:t}=yield V.auth.getUser();return{user:a,error:t}}),fo=({onStartDemo:a,onSignIn:t,onShowFeedback:s})=>{const[r,n]=S.useState(""),i=()=>{console.log("LandingPage: handleGetStarted called"),console.log("LandingPage: About to call onStartDemo"),console.log("LandingPage: onStartDemo function:",typeof a),a(),console.log("LandingPage: onStartDemo called successfully")},o=l=>g(W,null,function*(){if(l.preventDefault(),!!r)try{const{error:c}=yield V.from("email_signups").insert({email:r.trim().toLowerCase(),source:"landing-page"});if(c)if(c.code==="23505")alert(`Thanks! ${r} is already on our notification list.`);else throw c;else alert(`Thanks! We'll notify ${r} when FlowerCost Pro launches.`);n("")}catch(c){console.error("Email signup error:",c),alert("There was an error signing up. Please try again.")}});return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("img",{src:"/image.png",alt:"FlowerCost Pro",className:"h-36 w-auto"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),console.log("Landing page feedback button clicked"),s()},className:"text-blue-600 hover:text-blue-700 font-medium",children:"Give Feedback"}),e.jsx("button",{onClick:t,className:"text-gray-600 hover:text-gray-700 font-medium",children:"Sign In"}),e.jsx("button",{onClick:i,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Try Free Demo"})]})]})})}),e.jsx("section",{className:"bg-gradient-to-br from-green-50 to-blue-50 py-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-full text-sm font-medium inline-block mb-6",children:" Stop Losing Money on Arrangements"}),e.jsxs("h1",{className:"text-5xl font-bold text-gray-900 mb-6 leading-tight",children:["Train Staff to Maintain",e.jsx("span",{className:"text-green-600",children:" 40%+ Profit"})," Margins"]}),e.jsx("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:"FlowerCost Pro prevents costly pricing mistakes during busy seasons. Real-time cost tracking ensures every arrangement stays profitable, even with seasonal staff."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[e.jsxs("button",{onClick:i,className:"bg-green-600 text-white px-8 py-4 rounded-lg hover:bg-green-700 transition-colors font-semibold text-lg flex items-center justify-center gap-2",children:[e.jsx(vs,{className:"w-5 h-5"}),"Try Free Demo"]}),e.jsxs("form",{onSubmit:o,className:"flex gap-2",children:[e.jsx("input",{type:"email",value:r,onChange:l=>n(l.target.value),placeholder:"Enter your email",className:"flex-1 px-4 py-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-4 rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Get Notified"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"14-day free trial"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Works with any POS"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Cancel anytime"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 border",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium text-purple-800",children:"Staff Training Mode"})]}),e.jsxs("div",{className:"text-sm text-purple-700",children:["Customer Budget: ",e.jsx("span",{className:"font-bold",children:"$75.00"})]})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"Red Roses (12)"}),e.jsx("span",{className:"text-green-600 font-bold",children:"$30.00"})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"Baby's Breath (3)"}),e.jsx("span",{className:"text-green-600 font-bold",children:"$16.88"})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"Glass Vase (1)"}),e.jsx("span",{className:"text-green-600 font-bold",children:"$17.00"})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Total: $63.88"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-green-700 font-bold",children:"WITHIN BUDGET"})]})]}),e.jsx("div",{className:"text-sm text-green-600 mt-1",children:"$11.12 remaining"})]})]}),e.jsx("div",{className:"absolute -top-4 -right-4 bg-yellow-400 text-yellow-900 px-3 py-1 rounded-full text-sm font-bold",children:"Live Demo!"})]})]})})}),e.jsx("section",{className:"py-20 bg-red-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"The Hidden Profit Killer in Your Shop"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"During busy seasons, well-meaning staff create beautiful arrangements that lose money. One $20 mistake per day costs you $7,300 per year."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg border border-red-200",children:[e.jsx("div",{className:"bg-red-100 p-3 rounded-full w-fit mb-4",children:e.jsx(ue,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Seasonal Staff Mistakes"}),e.jsx("p",{className:"text-gray-600",children:"Holiday workers don't know your costs. They create gorgeous arrangements that sell at a loss because they used too many premium stems."})]}),e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg border border-red-200",children:[e.jsx("div",{className:"bg-red-100 p-3 rounded-full w-fit mb-4",children:e.jsx(zt,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Rush Hour Pressure"}),e.jsx("p",{className:"text-gray-600",children:"When customers are waiting, staff grab whatever looks good. No time to calculate costs means profit margins disappear."})]}),e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg border border-red-200",children:[e.jsx("div",{className:"bg-red-100 p-3 rounded-full w-fit mb-4",children:e.jsx(Ae,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Inconsistent Pricing"}),e.jsx("p",{className:"text-gray-600",children:"Different staff price similar arrangements differently. Customers notice, and your profit margins suffer."})]})]})]})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Real-Time Profit Protection"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"FlowerCost Pro guides staff to create profitable arrangements every time. No complex training required - just instant feedback."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsx("div",{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full flex-shrink-0",children:e.jsx(ye,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Staff Training Mode"}),e.jsx("p",{className:"text-gray-600",children:"Staff see customer budget and real-time cost tracking. Green means profitable, red means stop adding items."})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full flex-shrink-0",children:e.jsx(js,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Universal POS Integration"}),e.jsx("p",{className:"text-gray-600",children:"Works with Square, Clover, Toast, or any POS system. Simple copy/paste - no technical setup required."})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full flex-shrink-0",children:e.jsx(xs,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Profit Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Track which arrangements make money and which don't. Identify your most profitable products and staff performance."})]})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-2xl p-8",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full w-fit mx-auto mb-3",children:e.jsx(Ie,{className:"w-8 h-8 text-green-600"})}),e.jsx("h4",{className:"text-2xl font-bold text-gray-900",children:"Profit Impact"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg",children:[e.jsx("span",{className:"text-red-700",children:"Before FlowerCost Pro:"}),e.jsx("span",{className:"font-bold text-red-700",children:"25% margin"})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-green-700",children:"After FlowerCost Pro:"}),e.jsx("span",{className:"font-bold text-green-700",children:"45% margin"})]}),e.jsxs("div",{className:"text-center pt-4 border-t",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:"+$15,600"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Additional profit per year*"}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Based on $200/day average sales"})]})]})]})})]})]})}),e.jsx("section",{className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"text-center mb-16",children:e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Everything You Need to Protect Profits"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full w-fit mb-4",children:e.jsx(ye,{className:"w-6 h-6 text-green-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Staff Training Mode"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Real-time budget tracking prevents costly mistakes. Staff see exactly how much they can spend while staying profitable."})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full w-fit mb-4",children:e.jsx(xs,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Profit Analytics"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Track performance by product, staff member, and time period. Identify what's working and what's not."})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full w-fit mb-4",children:e.jsx(Ae,{className:"w-6 h-6 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Arrangement Recipes"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Save profitable arrangements as templates. Ensure consistency and maintain margins on popular designs."})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-full w-fit mb-4",children:e.jsx(js,{className:"w-6 h-6 text-orange-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Universal POS Integration"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Works with any point-of-sale system. Simple copy/paste integration - no technical setup required."})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"bg-red-100 p-3 rounded-full w-fit mb-4",children:e.jsx(Js,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Data Security"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Your business data is encrypted and backed up automatically. Access from any device, anywhere."})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"bg-yellow-100 p-3 rounded-full w-fit mb-4",children:e.jsx(zt,{className:"w-6 h-6 text-yellow-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Quick Setup"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Start protecting profits in under 10 minutes. Import your products and begin training staff immediately."})]})]})]})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"text-center mb-16",children:e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Florists Love FlowerCost Pro"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-8 border border-green-200",children:[e.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(5)].map((l,c)=>e.jsx($t,{className:"w-5 h-5 text-yellow-400 fill-current"},c))}),e.jsx("p",{className:"text-gray-700 mb-4 italic",children:'"Finally, a solution that actually works with our existing POS! My seasonal staff can now create arrangements without me worrying about profit margins."'}),e.jsx("div",{className:"font-semibold text-gray-900",children:"Sarah M."}),e.jsx("div",{className:"text-sm text-gray-600",children:"Bloom & Blossom Florist"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-8 border border-blue-200",children:[e.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(5)].map((l,c)=>e.jsx($t,{className:"w-5 h-5 text-yellow-400 fill-current"},c))}),e.jsx("p",{className:"text-gray-700 mb-4 italic",children:'"The staff training mode is genius. New employees understand profitable pricing in minutes, not hours. Our margins improved immediately."'}),e.jsx("div",{className:"font-semibold text-gray-900",children:"Mike R."}),e.jsx("div",{className:"text-sm text-gray-600",children:"Garden Gate Flowers"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-8 border border-purple-200",children:[e.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(5)].map((l,c)=>e.jsx($t,{className:"w-5 h-5 text-yellow-400 fill-current"},c))}),e.jsx("p",{className:"text-gray-700 mb-4 italic",children:`"I wish I had this during last Valentine's Day! The profit analytics showed me exactly which arrangements were losing money. Never again."`}),e.jsx("div",{className:"font-semibold text-gray-900",children:"Jennifer L."}),e.jsx("div",{className:"text-sm text-gray-600",children:"Petals & Stems"})]})]})]})}),e.jsx("section",{className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Simple, Transparent Pricing"}),e.jsx("p",{className:"text-xl text-gray-600",children:"One price, all features. Cancel anytime."})]}),e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border-2 border-green-500 relative",children:[e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"bg-green-500 text-white px-6 py-2 rounded-full text-sm font-bold",children:"MOST POPULAR"})}),e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"FlowerCost Pro"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("span",{className:"text-5xl font-bold text-gray-900",children:"$39"}),e.jsx("span",{className:"text-xl text-gray-600",children:"/month"})]}),e.jsxs("ul",{className:"space-y-3 mb-8 text-left",children:[e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Unlimited products & arrangements"})]}),e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Staff training mode"})]}),e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Profit analytics & reporting"})]}),e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Universal POS integration"})]}),e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Arrangement recipe library"})]}),e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Email support"})]}),e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"14-day free trial"})]})]}),e.jsxs("button",{onClick:i,className:"w-full bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition-colors font-semibold text-lg flex items-center justify-center gap-2",children:["Start Free Trial",e.jsx(Br,{className:"w-5 h-5"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"No credit card required  Cancel anytime"})]})]})}),e.jsxs("div",{className:"text-center mt-12",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:[e.jsx("strong",{children:"ROI Guarantee:"})," FlowerCost Pro pays for itself with just 1-2 prevented mistakes per month."]}),e.jsx("div",{className:"bg-green-100 border border-green-200 rounded-lg p-4 max-w-2xl mx-auto",children:e.jsx("p",{className:"text-green-800 font-medium",children:" Average customer saves $15,600+ per year in recovered profit margins"})})]})]})}),e.jsx("section",{className:"py-20 bg-green-600",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Stop Losing Money on Beautiful Arrangements"}),e.jsx("p",{className:"text-xl text-green-100 mb-8 max-w-3xl mx-auto",children:"Join hundreds of florists who've protected their profits with FlowerCost Pro. Start your free trial today - no credit card required."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsxs("button",{onClick:i,className:"bg-white text-green-600 px-8 py-4 rounded-lg hover:bg-gray-100 transition-colors font-semibold text-lg flex items-center gap-2",children:[e.jsx(vs,{className:"w-5 h-5"}),"Try Free Demo"]}),e.jsxs("form",{onSubmit:o,className:"flex gap-2",name:"email-signup-cta",children:[e.jsx("input",{type:"email",value:r,onChange:l=>n(l.target.value),placeholder:"Enter your email",className:"px-4 py-4 border border-green-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-white bg-green-500 text-white placeholder-green-200",required:!0}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-4 rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Get Notified"})]})]}),e.jsx("p",{className:"text-green-200 text-sm mt-6",children:" 14-day free trial   Works with any POS   Cancel anytime"})]})}),e.jsx("footer",{className:"bg-gray-900 text-white py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:e.jsx("img",{src:"/image.png",alt:"FlowerCost Pro",className:"h-24 w-auto"})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Professional florist profit analysis and staff training software."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Product"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Features"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Pricing"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Demo"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Support"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Help Center"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Contact Us"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Training"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Company"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"About"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Privacy"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-white",children:"Terms"})})]})]})]}),e.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-sm text-gray-400",children:e.jsx("p",{children:" 2024 FlowerCost Pro. All rights reserved."})})]})})]})},po=({onAuthSuccess:a,isPasswordReset:t=!1,onBackToLanding:s})=>{const[r,n]=S.useState(!1),[i,o]=S.useState(!1),[l,c]=S.useState(!1),[h,d]=S.useState(!1),[u,x]=S.useState({email:"",password:"",fullName:"",confirmPassword:""}),[b,m]=S.useState(null),[w,y]=S.useState(null);S.useEffect(()=>{t&&y("Please enter your new password below.")},[t]);const v=R=>g(W,null,function*(){R.preventDefault(),m(null),c(!0);const L=u.email.trim().toLowerCase();try{if(t){const{error:A}=yield V.auth.updateUser({password:u.password});if(A)throw A;alert("Password updated successfully! You are now signed in."),a();return}if(r){if(u.password!==u.confirmPassword)throw new Error("Passwords do not match");if(u.password.length<6)throw new Error("Password must be at least 6 characters");if(!u.fullName.trim())throw new Error("Full name is required");const{error:A}=yield mo(L,u.password,u.fullName);if(A)throw A;try{const{error:ee}=yield qs(L,u.password);ee?(alert("Account created! Please check your email for confirmation, then sign in."),n(!1),_()):a()}catch(ee){alert("Account created! Please check your email for confirmation, then sign in."),n(!1),_()}}else{const{error:A}=yield qs(L,u.password);if(A)throw A.message.includes("Invalid login credentials")?new Error("Email or password is incorrect. Please check your credentials and try again."):A.message.includes("Email not confirmed")?new Error("Please check your email and click the confirmation link before signing in."):A;a()}}catch(A){console.error("Authentication error:",A),m(A.message)}finally{c(!1)}}),C=()=>g(W,null,function*(){if(!u.email.trim()){m("Please enter your email address first");return}d(!0),m(null),y(null);try{const{error:R}=yield V.auth.resetPasswordForEmail(u.email.trim().toLowerCase(),{redirectTo:`${window.location.origin}?type=recovery&confirmed=true`});if(R)throw R;y("Password reset email sent! Check your inbox and follow the instructions.")}catch(R){console.error("Password reset error:",R),m(R.message)}finally{d(!1)}}),_=()=>{x({email:"",password:"",fullName:"",confirmPassword:""}),m(null),y(null)},E=()=>{n(!r),_()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:"/image.png",alt:"FlowerCost Pro",className:"h-36 w-auto mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:t?"Reset Password":r?"Create Account":"Welcome Back"}),e.jsx("p",{className:"text-gray-600",children:t?"Enter your new password below":r?"Start managing your flower shop profits":"Sign in to your FlowerCost Pro account"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[r&&!t&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:u.fullName,onChange:R=>x(O(T({},u),{fullName:R.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter your full name",required:!0})]}),!t&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:u.email,onChange:R=>x(O(T({},u),{email:R.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter your email",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t?"New Password":"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i?"text":"password",value:u.password,onChange:R=>x(O(T({},u),{password:R.target.value})),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:t?"Enter your new password":"Enter your password",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?e.jsx(la,{className:"w-5 h-5"}):e.jsx(Gs,{className:"w-5 h-5"})})]})]}),(r||t)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),e.jsx("input",{type:"password",value:u.confirmPassword,onChange:R=>x(O(T({},u),{confirmPassword:R.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Confirm your password",required:!0,minLength:6})]}),w&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsx("p",{className:"text-green-700 text-sm",children:w})}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 text-sm",children:b})}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsx(bs,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:[r?e.jsx(za,{className:"w-5 h-5"}):e.jsx(va,{className:"w-5 h-5"}),t?"Update Password":r?"Create Account":"Sign In"]})})]}),!r&&!t&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("button",{onClick:C,disabled:h,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center justify-center gap-1 mx-auto disabled:opacity-50",children:[h?e.jsx(bs,{className:"w-4 h-4 animate-spin"}):e.jsx(fa,{className:"w-4 h-4"}),"Forgot your password?"]})}),!t&&e.jsxs("div",{className:"mt-6 text-center",children:[s&&e.jsx("button",{onClick:s,className:"text-gray-600 hover:text-gray-700 font-medium mr-4",children:" Back to Home"}),e.jsx("button",{onClick:E,className:"text-green-600 hover:text-green-700 font-medium",children:r?"Already have an account? Sign in":"Don't have an account? Sign up"})]}),r&&!t&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"By creating an account, you agree to our Terms of Service and Privacy Policy. Your data is encrypted and secure."})})]})})},xo=({userRole:a,userName:t,storeName:s,onRoleChange:r,activeSection:n,onSectionChange:i,onLogout:o,onShowFeedback:l,children:c})=>{var w;const[h,d]=S.useState(!0),u=y=>{switch(y){case"owner":return e.jsx(ta,{className:"w-4 h-4 text-yellow-600"});case"manager":return e.jsx(Js,{className:"w-4 h-4 text-blue-600"});case"staff":return e.jsx(Ns,{className:"w-4 h-4 text-green-600"});default:return e.jsx(Ns,{className:"w-4 h-4"})}},x=y=>{switch(y){case"owner":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"manager":return"bg-blue-100 text-blue-800 border-blue-200";case"staff":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},m=[{id:"overview",label:"Overview",icon:ys,roles:["owner","manager","staff"]},{id:"create-order",label:"Create Order",icon:xe,roles:["owner","manager","staff"]},{id:"products",label:"Product Library",icon:He,roles:["owner","manager"]},{id:"recipes",label:"Arrangement Recipes",icon:Vt,roles:["owner","manager"]},{id:"orders",label:"Saved Orders",icon:xe,roles:["owner","manager"]},{id:"analytics",label:"Profit Analytics",icon:ue,roles:["owner","manager"]},{id:"insights",label:"Business Insights",icon:ue,roles:["owner","manager"]},{id:"settings",label:"Settings",icon:is,roles:["owner"]},{id:"staff-training",label:"Staff Training",icon:ye,roles:["owner"]}].filter(y=>y.roles.includes(a));return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsxs("div",{className:`${h?"w-64":"w-16"} bg-white shadow-lg transition-all duration-300 flex flex-col`,children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/image.png",alt:"FlowerCost Pro",className:"h-36 w-auto"}),h&&e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-gray-800 text-sm",children:"FlowerCost Pro"}),e.jsx("p",{className:"text-xs text-gray-500",children:s||"Your Flower Shop"})]})]})}),e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:u(a)}),h&&e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-800",children:t||"User"}),e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium border ${x(a)}`,children:[u(a),a.charAt(0).toUpperCase()+a.slice(1)]})]})]})}),e.jsx("nav",{className:"flex-1 p-4",children:e.jsx("ul",{className:"space-y-2",children:m.map(y=>{const v=y.icon,C=n===y.id;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>i(y.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${C?"bg-green-100 text-green-700 border border-green-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(v,{className:"w-5 h-5"}),h&&e.jsx("span",{className:"font-medium",children:y.label})]})},y.id)})})}),h&&e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:t==="Demo User"?"Demo Mode - Switch Role:":"Switch Role:"}),e.jsxs("select",{value:a,onChange:y=>r(y.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"owner",children:"Owner"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"staff",children:"Staff"})]})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>d(!h),className:"w-full flex items-center justify-center p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ys,{className:"w-5 h-5"})})})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:((w=m.find(y=>y.id===n))==null?void 0:w.label)||"Dashboard"}),e.jsx("p",{className:"text-gray-600",children:a==="staff"?"Create beautiful arrangements within budget":a==="manager"?"Manage products and monitor performance":"Full business control and analytics"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium border ${x(a)}`,children:[u(a),e.jsxs("span",{className:"ml-1",children:[a.charAt(0).toUpperCase()+a.slice(1)," Access"]})]}),e.jsxs("button",{onClick:y=>{y.preventDefault(),y.stopPropagation(),console.log("Dashboard feedback button clicked"),l()},className:"flex items-center gap-2 px-3 py-1 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors",title:"Give feedback",children:[e.jsx(_a,{className:"w-4 h-4"}),"Feedback"]}),e.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-3 py-1 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Sign out",children:[e.jsx(ja,{className:"w-4 h-4"}),"Sign Out"]})]})]})}),e.jsx("main",{className:"flex-1 p-6 overflow-y-auto",children:e.jsx("div",{"data-section":n,children:c})})]})]})},yo=({activeSection:a,userRole:t,orders:s,templates:r,children:n})=>{if(a!=="overview")return e.jsx(e.Fragment,{children:n});const i=s.reduce((b,m)=>b+m.totalRetail,0),o=s.reduce((b,m)=>b+m.profit,0),l=s.length>0?i/s.length:0,c=i>0?o/i*100:0,h=new Date;h.setDate(h.getDate()-7);const d=s.filter(b=>b.date>=h),u=new Map;s.forEach(b=>{if(b.staffName){const m=u.get(b.staffName)||{orders:0,revenue:0};m.orders+=1,m.revenue+=b.totalRetail,u.set(b.staffName,m)}});const x=Array.from(u.entries()).sort(([,b],[,m])=>m.revenue-b.revenue).slice(0,5);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 border border-green-200",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:["Welcome back",t==="staff"?"":" to your dashboard","!"]}),e.jsx("p",{className:"text-gray-600",children:t==="staff"?'Ready to create beautiful arrangements? Use the "Create Order" section to build arrangements within customer budgets.':t==="manager"?"Monitor your shop's performance and manage your product library.":"Here's an overview of your flower shop's performance and key metrics."})]}),(t==="owner"||t==="manager")&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(Ie,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("div",{className:"text-xl font-bold text-green-700 truncate",children:["$",i.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(ue,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Profit"}),e.jsxs("div",{className:"text-xl font-bold text-blue-700 truncate",children:["$",o.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-blue-600",children:[c.toFixed(1),"% margin"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(xe,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Order Value"}),e.jsxs("div",{className:"text-xl font-bold text-purple-700 truncate",children:["$",l.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx(He,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Products"}),e.jsx("div",{className:"text-xl font-bold text-orange-700",children:r.length}),e.jsxs("div",{className:"text-xs text-orange-600",children:[s.length," orders"]})]})]})})]}),t==="staff"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(xe,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Orders"}),e.jsx("div",{className:"text-xl font-bold text-green-700",children:s.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(He,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Products Available"}),e.jsx("div",{className:"text-xl font-bold text-blue-700",children:r.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(ye,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Recent Orders"}),e.jsx("div",{className:"text-xl font-bold text-purple-700",children:d.length}),e.jsx("div",{className:"text-xs text-purple-600",children:"Last 7 days"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600"}),"Recent Orders"]}),d.length>0?e.jsx("div",{className:"space-y-3",children:d.slice(0,5).map(b=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:b.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[b.date.toLocaleDateString(),"  ",b.products.length," items",b.staffName&&`  by ${b.staffName}`]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-green-600",children:["$",b.totalRetail.toFixed(2)]}),(t==="owner"||t==="manager")&&e.jsxs("div",{className:"text-sm text-gray-500",children:["$",b.profit.toFixed(2)," profit"]})]})]},b.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No recent orders"})]})]}),(t==="owner"||t==="manager")&&x.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600"}),"Top Performing Staff"]}),e.jsx("div",{className:"space-y-3",children:x.map(([b,m],w)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-yellow-100 rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold text-yellow-700",children:w+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:b}),e.jsxs("div",{className:"text-sm text-gray-500",children:[m.orders," orders"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-green-600",children:["$",m.revenue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"revenue"})]})]},b))})]}),t==="staff"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-purple-600"}),"Quick Actions"]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("h5",{className:"font-medium text-purple-800 mb-2",children:" Staff Tips"}),e.jsxs("ul",{className:"text-sm text-purple-700 space-y-1",children:[e.jsx("li",{children:" Always check customer budget before starting"}),e.jsx("li",{children:' Use "Create Order" to build arrangements'}),e.jsx("li",{children:" Copy order details to your POS when ready"}),e.jsx("li",{children:" Your name will be tracked with each order"})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:t==="staff"?"How to Create Orders":"Quick Start Guide"}),e.jsx("div",{className:`grid grid-cols-1 ${t==="staff"?"md:grid-cols-3":"md:grid-cols-2 lg:grid-cols-4"} gap-4`,children:t==="staff"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"font-medium text-green-800 mb-2",children:"1. Create Order"}),e.jsx("p",{className:"text-sm text-green-700",children:'Use "Create Order" to build arrangements with real-time cost tracking'})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"font-medium text-blue-800 mb-2",children:"2. Stay in Budget"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Watch the budget tracker to keep arrangements profitable"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"font-medium text-purple-800 mb-2",children:"3. Send to POS"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Copy order details and paste into your POS system"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"font-medium text-green-800 mb-2",children:"1. Configure Markup Settings"}),e.jsx("p",{className:"text-sm text-green-700",children:"Set your desired profit margins for different product types in Settings"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"font-medium text-blue-800 mb-2",children:"2. Add Products"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Build your product library with wholesale costs"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"font-medium text-purple-800 mb-2",children:"3. Create Recipes"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Save profitable arrangement formulas for consistent pricing"})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"font-medium text-yellow-800 mb-2",children:"4. Train Staff"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Enable staff to create orders with real-time profit tracking"})]})]})})]})]})},bo=({order:a,posSettings:t,onClose:s})=>{const[r,n]=S.useState("idle"),i=()=>({orderId:a.id,orderName:a.name,storeName:t.storeName,staffName:a.staffName,staffId:a.staffId,totalAmount:a.totalRetail,items:a.products.map(d=>({name:d.name,quantity:d.quantity,price:d.wholesaleCost*2.5,category:d.type})),notes:a.notes,timestamp:a.date.toISOString()}),o=()=>{const d=[];return d.push("=".repeat(50)),d.push(`ARRANGEMENT: ${a.name}`),d.push(`STAFF: ${a.staffName}${a.staffId?` (ID: ${a.staffId})`:""}`),d.push(`DATE: ${a.date.toLocaleDateString()} ${a.date.toLocaleTimeString()}`),d.push(`ORDER ID: #${a.id}`),d.push("=".repeat(50)),d.push(""),a.notes&&(d.push("CUSTOMER NOTES:"),d.push(a.notes),d.push("")),d.push("ITEMS:"),d.push("-".repeat(50)),a.products.forEach((u,x)=>{const b=u.wholesaleCost*2.5,m=b*u.quantity;d.push(`${x+1}. ${u.name} (${u.type})`),d.push(`   Qty: ${u.quantity} x $${b.toFixed(2)} = $${m.toFixed(2)}`),d.push("")}),d.push("-".repeat(50)),d.push(`TOTAL AMOUNT: $${a.totalRetail.toFixed(2)}`),d.push(`STAFF: ${a.staffName}`),d.push("=".repeat(50)),d.join(`
`)},l=()=>g(W,null,function*(){const d=o();console.log("Attempting to copy text:",d);try{yield navigator.clipboard.writeText(d),console.log("Clipboard write successful"),n("success"),alert(` SUCCESS! Order details copied to clipboard!

 NEXT STEPS:
1. Go to your your POS system
2. Create a new sale for $${a.totalRetail.toFixed(2)}
3. In the notes/description field, press Ctrl+V (or Cmd+V on Mac) to paste
4. Process customer payment

 Staff: ${a.staffName} will be recorded with this sale.`)}catch(u){console.error("Clipboard API failed:",u);try{const x=document.createElement("textarea");x.value=d,x.style.position="absolute",x.style.left="-9999px",x.style.top="0",x.style.opacity="0",document.body.appendChild(x),x.focus(),x.select();const b=document.execCommand("copy");if(document.body.removeChild(x),console.log("Fallback copy result:",b),b)n("success"),alert(` SUCCESS! Order details copied to clipboard!

 NEXT STEPS:
1. Go to your your POS system
2. Create a new sale for $${a.totalRetail.toFixed(2)}
3. In the notes/description field, press Ctrl+V (or Cmd+V on Mac) to paste
4. Process customer payment

 Staff: ${a.staffName} will be recorded with this sale.`);else throw new Error("Copy command failed")}catch(x){console.error("Fallback copy also failed:",x),n("error"),alert(" Copy failed. The manual copy area will appear below - please select all text and copy it manually.")}}}),c=()=>{var w;const d=i(),u=JSON.stringify(d,null,2),x=new Blob([u],{type:"application/json"}),b=URL.createObjectURL(x),m=document.createElement("a");m.href=b,m.download=`order_${a.id}_${(w=a.staffName)==null?void 0:w.replace(/\s+/g,"_")}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(b)},h=()=>{s()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"Send to POS System"}),e.jsx("p",{className:"text-gray-600",children:"Copy arrangement details to your point of sale"})]}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-600",children:e.jsx("span",{className:"text-2xl",children:""})})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Arrangement Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Name:"}),e.jsx("div",{className:"font-medium",children:a.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Staff:"}),e.jsx("div",{className:"font-medium",children:a.staffName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Total:"}),e.jsxs("div",{className:"font-bold text-green-600",children:["$",a.totalRetail.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Items:"}),e.jsxs("div",{className:"font-medium",children:[a.products.length," products"]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-purple-600",children:"POS System:"}),e.jsx("div",{className:"font-medium text-blue-600",children:"Manual Copy/Paste (Universal)"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Copy Order to Your POS"}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ht,{className:"w-5 h-5 text-blue-600"}),e.jsx("h5",{className:"font-medium text-gray-800",children:"Copy Order Details"}),e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:"UNIVERSAL"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Copy the formatted order details and paste them into any POS system."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:l,className:"bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2 font-medium",children:[e.jsx(Ht,{className:"w-4 h-4"})," Copy Order Details"]}),e.jsxs("button",{onClick:c,className:"bg-gray-600 text-white px-6 py-3 rounded-md hover:bg-gray-700 transition-colors flex items-center gap-2",children:[e.jsx(aa,{className:"w-4 h-4"}),"Download Backup"]})]})]})]}),r==="success"&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-800",children:" Order details copied to clipboard!"}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"Now go to your POS system and paste (Ctrl+V or Cmd+V) in the order notes."})]})]})}),r==="error"&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-800",children:" Copy to clipboard failed"}),e.jsx("div",{className:"text-sm text-red-700 mt-1",children:"Please manually copy the order details from the text box below."})]})]})}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-gray-800 mb-2",children:" Step-by-Step Instructions:"}),e.jsxs("ol",{className:"text-sm text-gray-600 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:'Click " Copy Order Details" button above'}),e.jsx("li",{children:"Go to your POS system and create a new sale"}),e.jsxs("li",{children:["Enter the total amount: ",e.jsxs("strong",{children:["$",a.totalRetail.toFixed(2)]})]}),e.jsxs("li",{children:["In the notes/description field, press ",e.jsx("strong",{children:"Ctrl+V"})," (or ",e.jsx("strong",{children:"Cmd+V"})," on Mac) to paste"]}),e.jsx("li",{children:"Process payment with customer"}),e.jsxs("li",{children:["The staff name (",a.staffName,") will be recorded with the sale"]})]}),e.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded border border-blue-200",children:e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:" Tip:"}),' After clicking "Copy Order Details", the information is saved to your clipboard. You can then paste it anywhere by pressing Ctrl+V (Windows) or Cmd+V (Mac).']})})]}),(r==="error"||r==="idle")&&e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-yellow-800 mb-2",children:r==="error"?"Manual Copy - Select All Text Below:":"Order Details (Manual Copy if needed):"}),e.jsx("textarea",{value:o(),readOnly:!0,className:"w-full h-48 p-3 border border-yellow-300 rounded-md text-sm font-mono bg-white resize-none",onClick:d=>d.currentTarget.select()}),e.jsx("p",{className:"text-xs text-yellow-700 mt-2",children:"Click in the text area above, press Ctrl+A to select all, then Ctrl+C to copy. Then paste in your POS with Ctrl+V."})]})]})})})},vo=({templates:a,recipes:t,markupSettings:s,onSaveOrder:r,onOrderChange:n,userRole:i="owner",posSettings:o})=>{const[l,c]=S.useState([]),[h,d]=S.useState(""),[u,x]=S.useState(""),[b,m]=S.useState(""),[w,y]=S.useState(""),[v,C]=S.useState(""),[_,E]=S.useState(""),[R,L]=S.useState(""),[A,ee]=S.useState("custom"),[Q,me]=S.useState(""),[be,le]=S.useState(!1),[ke,ge]=S.useState(!1),[ce,N]=S.useState(null),[D,p]=S.useState(!1),f=a.filter(k=>k.name.toLowerCase().includes(h.toLowerCase().trim())),j=t.filter(k=>k.name.toLowerCase().includes(Q.toLowerCase().trim())),P=(k,M=1)=>{const K=s[k.type],U=k.wholesaleCost*K,q=k.wholesaleCost*M,Z=U*M,ot={id:`order-item-${Date.now()}`,name:k.name,wholesaleCost:k.wholesaleCost,quantity:M,type:k.type,retailPrice:U,totalWholesale:q,totalRetail:Z},lt=[...l,ot];if(c(lt),d(""),le(!1),n){const kt=lt.map(Ce=>({id:Ce.id,name:Ce.name,wholesaleCost:Ce.wholesaleCost,quantity:Ce.quantity,type:Ce.type}));n(kt)}},B=k=>{const M=[];let K=[];if(k.ingredients.forEach(U=>{const q=a.find(Z=>Z.name.toLowerCase().includes(U.name.toLowerCase())||U.name.toLowerCase().includes(Z.name.toLowerCase()));if(q){const Z=s[U.type],ot=q.wholesaleCost*Z,lt=q.wholesaleCost*U.quantity,kt=ot*U.quantity,Ce={id:`recipe-item-${Date.now()}-${Math.random()}`,name:U.name,wholesaleCost:q.wholesaleCost,quantity:U.quantity,type:U.type,retailPrice:ot,totalWholesale:lt,totalRetail:kt};M.push(Ce)}else K.push(U.name)}),K.length>0){alert(`Missing ingredients in your library: ${K.join(", ")}. Please add these items to your product library first.`);return}if(c([...l,...M]),x(k.name),me(""),ge(!1),n){const U=[...l,...M].map(q=>({id:q.id,name:q.name,wholesaleCost:q.wholesaleCost,quantity:q.quantity,type:q.type}));n(U)}},z=(k,M)=>{if(M<=0){te(k);return}const K=l.map(U=>{if(U.id===k){const q=U.wholesaleCost*M,Z=U.retailPrice*M;return O(T({},U),{quantity:M,totalWholesale:q,totalRetail:Z})}return U});if(c(K),n){const U=K.map(q=>({id:q.id,name:q.name,wholesaleCost:q.wholesaleCost,quantity:q.quantity,type:q.type}));n(U)}},G=(k,M)=>{c(l.map(K=>{if(K.id===k){const U=M*K.quantity;return O(T({},K),{retailPrice:M,totalRetail:U})}return K}))},te=k=>{const M=l.filter(K=>K.id!==k);if(c(M),n){const K=M.map(U=>({id:U.id,name:U.name,wholesaleCost:U.wholesaleCost,quantity:U.quantity,type:U.type}));n(K)}},Se=()=>{c([]),x(""),m(""),y(""),L(""),ee("custom"),me(""),d(""),n&&n([])};S.useEffect(()=>(typeof window!="undefined"&&(window.clearCurrentOrder=Se),()=>{typeof window!="undefined"&&delete window.clearCurrentOrder}),[]);const Ue=k=>{var K;const M=(K=k.target.files)==null?void 0:K[0];if(M){const U=new FileReader;U.onload=q=>{var Z;y((Z=q.target)==null?void 0:Z.result)},U.readAsDataURL(M)}},de=()=>{if(!u.trim()||l.length===0){u.trim()?alert("Please add at least one item to the order."):alert("Please enter an order name before saving.");return}if(i==="staff"&&!v.trim()){alert("Please enter your name before saving the order.");return}console.log("Creating order with items:",l),console.log("Current POS settings:",o);const k=l.reduce((q,Z)=>q+Z.totalWholesale,0),M=l.reduce((q,Z)=>q+Z.totalRetail,0),K=M-k,U={id:Date.now().toString(),name:u,date:new Date,products:l.map(q=>({id:q.id,name:q.name,wholesaleCost:q.wholesaleCost,quantity:q.quantity,type:q.type})),totalWholesale:k,totalRetail:M,profit:K,photo:w||void 0,notes:b||void 0,staffName:v||void 0,staffId:_||void 0};console.log("Final order object:",U),r(U),i==="staff"?(console.log("Staff mode - checking store configuration:",o.isConfigured,o.storeName),o.isConfigured&&o.storeName?(N(U),p(!0)):alert(`Store not configured. Please contact your manager to set up store information.
        
Debug info:
- isConfigured: ${o.isConfigured}
- storeName: ${o.storeName}`)):setTimeout(()=>{Se()},100)},ve=l.reduce((k,M)=>k+M.totalWholesale,0),ne=l.reduce((k,M)=>k+M.totalRetail,0),Le=ne-ve,br=k=>{switch(k){case"stem":return"bg-green-100 text-green-800";case"vase":return"bg-blue-100 text-blue-800";case"accessory":return"bg-purple-100 text-purple-800";case"other":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:i==="staff"?"Create Arrangement":"Create New Order"}),i==="staff"&&e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs font-semibold px-2 py-1 rounded-full",children:"STAFF MODE"})]}),i==="staff"&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-purple-800 mb-4",children:"Customer Requirements"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-purple-700 mb-1",children:"Customer's Budget ($) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:R,onChange:k=>L(k.target.value),className:"w-full px-3 py-2 border border-purple-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"e.g., 75.00"}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"This will be used for budget tracking in Staff Training Mode"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-purple-700 mb-1",children:"Arrangement Type"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"arrangementMode",value:"custom",checked:A==="custom",onChange:k=>ee(k.target.value),className:"mr-2 text-purple-600"}),e.jsx("span",{className:"text-sm",children:"Designer's Choice (Custom)"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"arrangementMode",value:"recipe",checked:A==="recipe",onChange:k=>ee(k.target.value),className:"mr-2 text-purple-600"}),e.jsx("span",{className:"text-sm",children:"Use Existing Recipe"})]})]})]})]})]}),D&&ce&&e.jsx(bo,{order:ce,posSettings:o,onClose:()=>{p(!1),N(null)}}),e.jsxs("div",{className:`mb-6 ${i==="staff"?"grid grid-cols-1":"grid grid-cols-1 lg:grid-cols-2 gap-6"}`,children:[(i!=="staff"||A==="recipe")&&e.jsxs("div",{className:i==="staff"?"mb-6":"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:i==="staff"?" Select Recipe to Customize":" Add Arrangement Recipe"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ft,{className:"w-4 h-4 text-gray-400 absolute left-3"}),e.jsx("input",{type:"text",value:Q,onChange:k=>{me(k.target.value),ge(k.target.value.length>0)},onFocus:()=>ge(Q.length>0),className:"w-full pl-10 pr-4 py-2 border border-emerald-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:i==="staff"?"Search recipes to start with...":"Search arrangement recipes..."})]}),ke&&j.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:j.map(k=>{const M=k.ingredients.reduce((K,U)=>K+U.quantity,0);return e.jsx("div",{onClick:()=>B(k),className:"p-3 hover:bg-emerald-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:k.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[M," items  Website: $",k.websitePrice.toFixed(2)]}),e.jsx("div",{className:"text-xs text-emerald-600",children:i==="staff"?"Click to start with this recipe (you can modify)":"Click to add all ingredients to order"})]}),k.photo&&e.jsx("img",{src:k.photo,alt:k.name,className:"w-12 h-12 object-cover rounded-md"})]})},k.id)})})]})]}),(i!=="staff"||A==="custom")&&e.jsxs("div",{className:i==="staff"?"mb-6":"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:i==="staff"?" Build Custom Arrangement":" Add Individual Products"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ft,{className:"w-4 h-4 text-gray-400 absolute left-3"}),e.jsx("input",{type:"text",value:h,onChange:k=>{d(k.target.value),le(k.target.value.trim().length>0)},onFocus:()=>le(h.trim().length>0),onBlur:()=>setTimeout(()=>le(!1),300),className:"w-full pl-10 pr-4 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:i==="staff"?"Search flowers, vases, accessories...":"Search individual products..."})]}),be&&h.trim().length>0&&f.length===0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-3",children:e.jsx("div",{className:"text-gray-500 text-sm",children:"No products found. Try a different search term."})}),be&&h.trim().length>0&&f.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:f.map(k=>e.jsx("div",{onClick:()=>P(k),className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:k.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["$",k.wholesaleCost.toFixed(2),"  ",k.type]})]}),e.jsxs("div",{className:"text-sm text-blue-600",children:["$",(k.wholesaleCost*s[k.type]).toFixed(2)," retail"]})]})},k.id))})]})]})]}),l.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Order Items"}),e.jsx("div",{className:"space-y-3",children:l.map(k=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:k.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${br(k.type)}`,children:k.type})]}),e.jsx("button",{onClick:()=>te(k.id),className:"text-red-500 hover:text-red-700",children:e.jsx(pt,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 mb-1",children:"Quantity"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>z(k.id,k.quantity-1),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300",children:e.jsx(Sa,{className:"w-3 h-3"})}),e.jsx("span",{className:"w-12 text-center font-medium",children:k.quantity}),e.jsx("button",{onClick:()=>z(k.id,k.quantity+1),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300",children:e.jsx(Re,{className:"w-3 h-3"})})]})]}),i!=="staff"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 mb-1",children:"Wholesale Cost"}),e.jsxs("div",{className:"font-medium",children:["$",k.wholesaleCost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 mb-1",children:i==="staff"?"Price Each":"Retail Price (Editable)"}),i==="staff"?e.jsxs("div",{className:"font-medium",children:["$",k.retailPrice.toFixed(2)]}):e.jsx("input",{type:"number",step:"0.01",min:"0",value:k.retailPrice.toFixed(2),onChange:M=>G(k.id,parseFloat(M.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-600 mb-1",children:i==="staff"?"Total Cost":"Total Retail"}),e.jsxs("div",{className:"font-bold text-blue-600",children:["$",k.totalRetail.toFixed(2)]})]})]})]},k.id))}),e.jsxs("div",{className:"mt-6 bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Order Summary"}),e.jsxs("div",{className:`grid gap-4 text-sm ${i==="staff"?"grid-cols-1":"grid-cols-3"}`,children:[i!=="staff"&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Wholesale:"}),e.jsxs("div",{className:"font-medium",children:["$",ve.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:i==="staff"?"Total Order Cost:":"Total Retail:"}),e.jsxs("div",{className:"font-medium text-blue-600",children:["$",ne.toFixed(2)]})]}),i!=="staff"&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Profit:"}),e.jsxs("div",{className:"font-bold text-green-700",children:["$",Le.toFixed(2)]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 gap-4 p-4 rounded-lg border-2 ${i==="staff"?"bg-purple-50 border-purple-300":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:i==="staff"?"Your Name *":"Staff Member Name"}),e.jsx("input",{type:"text",value:v,onChange:k=>C(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:i==="staff"?"Enter your name":"Staff member who created this order"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:i==="staff"?"Your Employee ID (Optional)":"Staff ID (Optional)"}),e.jsx("input",{type:"text",value:_,onChange:k=>E(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:i==="staff"?"Your employee ID":"Employee ID"})]}),i==="staff"&&e.jsxs("div",{className:"col-span-2 text-sm text-purple-700 bg-purple-100 p-2 rounded",children:[" ",e.jsx("strong",{children:"Your info will be included in all order records"})," - This helps track who created each arrangement for training and accountability."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Name *"}),e.jsx("input",{type:"text",value:u,onChange:k=>x(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Wedding Centerpieces - Smith",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:b,onChange:k=>m(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional notes about this order..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Photo (Optional)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Upload Photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:Ue,className:"hidden"})]}),w&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w,alt:"Order preview",className:"w-16 h-16 object-cover rounded-md"}),e.jsx("button",{onClick:()=>y(""),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:""})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:de,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),i==="staff"?"Save & Send to POS":"Save Order"]}),e.jsx("button",{onClick:Se,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Clear"})]})]})]}),l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:i==="staff"?A==="custom"?"Start typing to search for products and create your custom arrangement":"Search for a recipe above to start with, then customize as needed":"Start typing to search for products in your library"}),i==="staff"&&e.jsxs("div",{className:"mt-4 p-4 bg-purple-50 rounded-lg max-w-md mx-auto",children:[e.jsxs("h4",{className:"font-medium text-purple-800 mb-2",children:[" ",A==="custom"?"Designer's Choice Tips:":"Recipe Customization Tips:"]}),e.jsx("ul",{className:"text-sm text-purple-700 text-left space-y-1",children:A==="custom"?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:' Search for "roses", "carnations", "vase", etc.'}),e.jsx("li",{children:" Add products one by one to build your arrangement"}),e.jsx("li",{children:" Watch the Staff Training budget tracker"}),e.jsx("li",{children:" Adjust quantities to meet customer's budget"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:" Start with a recipe, then modify as needed"}),e.jsx("li",{children:" Add or remove items to fit customer's budget"}),e.jsx("li",{children:" Adjust quantities to personalize the arrangement"}),e.jsx("li",{children:" Use recipes as inspiration, not strict rules"})]})})]})]})]})},wo=({templates:a,markupSettings:t,onUpdateTemplate:s,onDeleteTemplate:r})=>{const[n,i]=S.useState(""),[o,l]=S.useState("all"),[c,h]=S.useState(null),[d,u]=S.useState({name:"",wholesaleCost:"",type:"stem"}),x=[...a].filter(v=>{const C=v.name.toLowerCase().includes(n.toLowerCase()),_=o==="all"||v.type===o;return C&&_}).sort((v,C)=>v.name.toLowerCase().localeCompare(C.name.toLowerCase())),b=v=>{h(v.id),u({name:v.name,wholesaleCost:v.wholesaleCost.toString(),type:v.type})},m=()=>{if(c){if(!d.name.trim()||!d.wholesaleCost||parseFloat(d.wholesaleCost)<=0){alert("Please enter a valid product name and wholesale cost.");return}s(c,{name:d.name.trim(),wholesaleCost:parseFloat(d.wholesaleCost),type:d.type}),h(null),u({name:"",wholesaleCost:"",type:"stem"})}},w=()=>{h(null),u({name:"",wholesaleCost:"",type:"stem"})},y=v=>{switch(v){case"stem":return"bg-green-100 text-green-800";case"vase":return"bg-blue-100 text-blue-800";case"accessory":return"bg-purple-100 text-purple-800";case"other":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return a.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Et,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Product Library"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Et,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Your product library is empty. Add products to build your library automatically."})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Et,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Product Library"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",x.length," of ",a.length," items)"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ft,{className:"w-4 h-4 text-gray-400 absolute left-3 top-3"}),e.jsx("input",{type:"text",value:n,onChange:v=>i(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Search products..."})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ma,{className:"w-4 h-4 text-gray-400 absolute left-3 top-3"}),e.jsxs("select",{value:o,onChange:v=>l(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"stem",children:"Stems Only"}),e.jsx("option",{value:"vase",children:"Vases Only"}),e.jsx("option",{value:"accessory",children:"Accessories Only"}),e.jsx("option",{value:"other",children:"Other Items"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map(v=>e.jsx("div",{id:`template-${v.id}`,className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-300",children:c===v.id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",value:d.name,onChange:C=>u(O(T({},d),{name:C.target.value})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsxs("select",{value:d.type,onChange:C=>u(O(T({},d),{type:C.target.value})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",children:[e.jsx("option",{value:"stem",children:"Stem"}),e.jsx("option",{value:"vase",children:"Vase"}),e.jsx("option",{value:"accessory",children:"Accessory"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:d.wholesaleCost,onChange:C=>u(O(T({},d),{wholesaleCost:C.target.value})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:m,className:"flex-1 bg-green-600 text-white py-1 px-2 rounded text-sm hover:bg-green-700 transition-colors",children:"Save"}),e.jsx("button",{onClick:w,className:"flex-1 bg-gray-500 text-white py-1 px-2 rounded text-sm hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-800 text-sm",children:v.name}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>b(v),className:"text-gray-400 hover:text-blue-600 transition-colors",title:"Edit template",children:e.jsx(Ks,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>r(v.id),className:"text-gray-400 hover:text-red-600 transition-colors",title:"Delete template",children:e.jsx(Ze,{className:"w-3 h-3"})})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${y(v.type)}`,children:v.type})}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Wholesale:"}),e.jsxs("span",{className:"font-medium",children:["$",v.wholesaleCost.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Retail Price:"}),e.jsxs("span",{className:"font-bold text-green-600",children:["$",(v.wholesaleCost*t[v.type]).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Markup:"}),e.jsxs("span",{className:"text-blue-600",children:[t[v.type],"x"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-3",children:[e.jsx(zt,{className:"w-3 h-3"}),e.jsxs("span",{children:["Last used: ",v.lastUsed.toLocaleDateString()]})]}),e.jsx("div",{className:"text-center text-xs text-gray-500 bg-gray-50 py-2 rounded",children:'Use "Create New Order" to add this product'})]})},v.id))})]})},jo=({onAddProduct:a})=>{const[t,s]=S.useState({name:"",wholesaleCost:"",quantity:"1",type:"stem"}),r=n=>{n.preventDefault(),!(!t.name||!t.wholesaleCost)&&(a({name:t.name,wholesaleCost:parseFloat(t.wholesaleCost),quantity:parseInt(t.quantity),type:t.type}),s({name:"",wholesaleCost:"",quantity:"1",type:"stem"}))};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Re,{className:"w-5 h-5 text-green-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Add New Product"})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name"}),e.jsx("input",{type:"text",value:t.name,onChange:n=>s(O(T({},t),{name:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"e.g., Red Roses",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:t.type,onChange:n=>s(O(T({},t),{type:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"stem",children:"Stem"}),e.jsx("option",{value:"vase",children:"Vase"}),e.jsx("option",{value:"accessory",children:"Accessory"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wholesale Cost ($)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.wholesaleCost,onChange:n=>s(O(T({},t),{wholesaleCost:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0.00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:t.quantity,onChange:n=>s(O(T({},t),{quantity:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0})]})]}),e.jsxs("button",{type:"submit",className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Add Product"]})]})]})},No=({markupSettings:a,onMarkupChange:t})=>{const[s,r]=S.useState(a),[n,i]=S.useState(!1);S.useEffect(()=>{r(a),i(!1)},[a]);const o=(c,h)=>{const d=parseFloat(h)||0,u=O(T({},s),{[c]:d});r(u),i(!0)},l=()=>{console.log("MarkupSettings: handleSave called with:",s);try{t(s),i(!1),console.log("MarkupSettings: Settings saved successfully"),alert("Markup settings saved successfully!")}catch(c){console.error("MarkupSettings: Error saving settings:",c),alert("Error saving markup settings. Please try again.")}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(is,{className:"w-5 h-5 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Markup Settings"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stems Markup"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",min:"1",value:s.stem,onChange:c=>o("stem",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("span",{className:"absolute right-3 top-2 text-gray-500 text-sm",children:"x"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vases Markup"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",min:"1",value:s.vase,onChange:c=>o("vase",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("span",{className:"absolute right-3 top-2 text-gray-500 text-sm",children:"x"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Accessories Markup"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",min:"1",value:s.accessory,onChange:c=>o("accessory",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("span",{className:"absolute right-3 top-2 text-gray-500 text-sm",children:"x"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other Items Markup"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",min:"1",value:s.other,onChange:c=>o("other",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("span",{className:"absolute right-3 top-2 text-gray-500 text-sm",children:"x"})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsxs("button",{onClick:l,disabled:!n,className:"bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ns,{className:"w-4 h-4"}),"Save Markup Settings"]}),n&&e.jsx("span",{className:"text-sm text-amber-600",children:"You have unsaved changes"})]}),e.jsx("div",{className:"mt-4 p-3 bg-purple-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-700",children:[e.jsx("strong",{children:"Markup multipliers"})," determine your retail pricing. For example, a 2.5x markup on a $4 wholesale stem = $10 retail price."]})})]})},_o=({orders:a,onDeleteOrder:t})=>{const[s,r]=S.useState(""),[n,i]=S.useState("date"),[o,l]=S.useState(null);if(a.length===0)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Tt,{className:"w-5 h-5 text-teal-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Saved Orders"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Tt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No saved orders yet. Save your first order to keep records."})]})]});const c=[...a].filter(h=>h.name.toLowerCase().includes(s.toLowerCase())).sort((h,d)=>{switch(n){case"name":return h.name.toLowerCase().localeCompare(d.name.toLowerCase());case"profit":return d.profit-h.profit;case"date":default:return new Date(d.date).getTime()-new Date(h.date).getTime()}});return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Tt,{className:"w-5 h-5 text-teal-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Saved Orders"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",c.length," of ",a.length," orders)"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ft,{className:"w-4 h-4 text-gray-400 absolute left-3 top-3"}),e.jsx("input",{type:"text",value:s,onChange:h=>r(h.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500",placeholder:"Search orders..."})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Vr,{className:"w-4 h-4 text-gray-400 absolute left-3 top-3"}),e.jsxs("select",{value:n,onChange:h=>i(h.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500 appearance-none",children:[e.jsx("option",{value:"date",children:"Sort by Date (Newest)"}),e.jsx("option",{value:"name",children:"Sort by Name (A-Z)"}),e.jsx("option",{value:"profit",children:"Sort by Profit (Highest)"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(h=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-medium text-gray-800 text-sm line-clamp-2",children:h.name}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>l(h),className:"text-gray-400 hover:text-teal-600 transition-colors",title:"View details",children:e.jsx(Gs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>t(h.id),className:"text-gray-400 hover:text-red-600 transition-colors",title:"Delete order",children:e.jsx(Ze,{className:"w-4 h-4"})})]})]}),h.photo&&e.jsx("div",{className:"mb-3",children:e.jsx("img",{src:h.photo,alt:h.name,className:"w-full h-24 object-cover rounded-md"})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(gt,{className:"w-3 h-3"}),e.jsx("span",{children:h.date.toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ie,{className:"w-3 h-3"}),e.jsxs("span",{children:["Profit: $",h.profit.toFixed(2)]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[h.products.length," items  $",h.totalRetail.toFixed(2)," retail"]})]})]},h.id))}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:o.name}),e.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx("span",{className:"text-2xl",children:""})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(gt,{className:"w-4 h-4"}),e.jsx("span",{children:o.date.toLocaleDateString()})]})}),o.photo&&e.jsx("div",{children:e.jsx("img",{src:o.photo,alt:o.name,className:"w-full max-w-md mx-auto rounded-lg"})}),o.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Notes"}),e.jsx("p",{className:"text-gray-600 text-sm bg-gray-50 p-3 rounded-md",children:o.notes})]}),o.staffName&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Staff Information"}),e.jsxs("div",{className:"text-gray-600 text-sm bg-gray-50 p-3 rounded-md",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",o.staffName]}),o.staffId&&e.jsxs("div",{children:[e.jsx("strong",{children:"Employee ID:"})," ",o.staffId]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Financial Summary"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Wholesale:"}),e.jsxs("div",{className:"font-medium",children:["$",o.totalWholesale.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Retail:"}),e.jsxs("div",{className:"font-medium text-green-600",children:["$",o.totalRetail.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Profit:"}),e.jsxs("div",{className:"font-bold text-green-700",children:["$",o.profit.toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-800 mb-3",children:["Products (",o.products.length," items)"]}),e.jsx("div",{className:"space-y-2",children:o.products.map((h,d)=>e.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 rounded-md text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:h.name}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",h.type,")"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{children:["Qty: ",h.quantity]}),e.jsxs("div",{className:"text-gray-600",children:["$",h.wholesaleCost.toFixed(2)," each"]})]})]},d))})]})]})]})})})]})},ko=({recipes:a,templates:t,markupSettings:s,onSaveRecipe:r,onDeleteRecipe:n,onUpdateRecipe:i})=>{const[o,l]=S.useState(!1),[c,h]=S.useState(null),[d,u]=S.useState(null),[x,b]=S.useState({name:"",description:"",websitePrice:"",websiteUrl:"",photo:"",ingredients:[]}),[m,w]=S.useState({name:"",description:"",websitePrice:"",websiteUrl:"",photo:"",ingredients:[]}),[y,v]=S.useState({name:"",quantity:"1",type:"stem",notes:""}),[C,_]=S.useState({name:"",quantity:"1",type:"stem",notes:""}),E=N=>{let D=0,p=0,f=[];N.ingredients.forEach(z=>{const G=t.find(te=>te.name.toLowerCase().includes(z.name.toLowerCase())||z.name.toLowerCase().includes(te.name.toLowerCase()));if(G){const te=G.wholesaleCost*z.quantity,Se=s[z.type],Ue=G.wholesaleCost*Se*z.quantity;D+=te,p+=Ue}else f.push(z.name)});const j=p-D,P=N.websitePrice-D,B=P-j;return{totalWholesale:D,totalRetail:p,profit:j,websiteProfit:P,profitDifference:B,missingItems:f,canCalculate:f.length===0}},R=()=>{y.name&&(b(O(T({},x),{ingredients:[...x.ingredients,{name:y.name,quantity:parseInt(y.quantity),type:y.type,notes:y.notes||void 0}]})),v({name:"",quantity:"1",type:"stem",notes:""}))},L=N=>{b(O(T({},x),{ingredients:x.ingredients.filter((D,p)=>p!==N)}))},A=N=>{var p;const D=(p=N.target.files)==null?void 0:p[0];if(D){const f=new FileReader;f.onload=j=>{var P;b(O(T({},x),{photo:(P=j.target)==null?void 0:P.result}))},f.readAsDataURL(D)}},ee=()=>{var N,D;if(!x.name||x.ingredients.length===0){alert("Please enter a recipe name and add at least one ingredient.");return}try{const p={id:Date.now().toString(),name:x.name.trim(),description:((N=x.description)==null?void 0:N.trim())||void 0,websitePrice:parseFloat(x.websitePrice)||0,websiteUrl:((D=x.websiteUrl)==null?void 0:D.trim())||void 0,photo:x.photo||void 0,ingredients:x.ingredients.map(f=>{var j;return O(T({},f),{name:f.name.trim(),notes:((j=f.notes)==null?void 0:j.trim())||void 0})}),lastUpdated:new Date};r(p),b({name:"",description:"",websitePrice:"",websiteUrl:"",photo:"",ingredients:[]}),l(!1)}catch(p){console.error("Error creating recipe:",p),alert("Error saving recipe. Please check your data and try again.")}},Q=N=>{h(N.id),w({name:N.name,description:N.description||"",websitePrice:N.websitePrice.toString(),websiteUrl:N.websiteUrl||"",photo:N.photo||"",ingredients:[...N.ingredients]})},me=()=>{if(!m.name||m.ingredients.length===0){alert("Please enter a recipe name and add at least one ingredient.");return}const N={name:m.name,description:m.description||void 0,websitePrice:parseFloat(m.websitePrice)||0,websiteUrl:m.websiteUrl||void 0,photo:m.photo||void 0,ingredients:m.ingredients,lastUpdated:new Date};i(c,N),h(null)},be=()=>{h(null),w({name:"",description:"",websitePrice:"",websiteUrl:"",photo:"",ingredients:[]})},le=()=>{C.name&&(w(O(T({},m),{ingredients:[...m.ingredients,{name:C.name,quantity:parseInt(C.quantity),type:C.type,notes:C.notes||void 0}]})),_({name:"",quantity:"1",type:"stem",notes:""}))},ke=N=>{w(O(T({},m),{ingredients:m.ingredients.filter((D,p)=>p!==N)}))},ge=N=>{var p;const D=(p=N.target.files)==null?void 0:p[0];if(D){const f=new FileReader;f.onload=j=>{var P;w(O(T({},m),{photo:(P=j.target)==null?void 0:P.result}))},f.readAsDataURL(D)}},ce=N=>{switch(N){case"stem":return"bg-green-100 text-green-800";case"vase":return"bg-blue-100 text-blue-800";case"accessory":return"bg-purple-100 text-purple-800";case"other":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vt,{className:"w-5 h-5 text-emerald-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Arrangement Recipes"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",a.length," recipes)"]})]}),e.jsxs("button",{onClick:()=>l(!o),className:"bg-emerald-600 text-white px-4 py-2 rounded-md hover:bg-emerald-700 transition-colors flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Add Recipe"]})]}),o&&e.jsxs("div",{className:"bg-emerald-50 rounded-lg p-6 mb-6 border border-emerald-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Create New Arrangement Recipe"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Arrangement Name *"}),e.jsx("input",{type:"text",value:x.name,onChange:N=>b(O(T({},x),{name:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"e.g., Spring Garden Bouquet"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website Price ($)"}),e.jsx("input",{type:"number",step:"0.01",value:x.websitePrice,onChange:N=>b(O(T({},x),{websitePrice:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"0.00"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),e.jsx("textarea",{value:x.description,onChange:N=>b(O(T({},x),{description:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",rows:2,placeholder:"Brief description of the arrangement..."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website URL (Optional)"}),e.jsx("input",{type:"url",value:x.websiteUrl,onChange:N=>b(O(T({},x),{websiteUrl:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"https://yourwebsite.com/arrangements/spring-garden"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Photo (Optional)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Upload Photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"hidden"})]}),x.photo&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:x.photo,alt:"Recipe preview",className:"w-16 h-16 object-cover rounded-md"}),e.jsx("button",{onClick:()=>b(O(T({},x),{photo:""})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:""})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Recipe Ingredients"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 mb-3",children:[e.jsx("input",{type:"text",value:y.name,onChange:N=>v(O(T({},y),{name:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Ingredient name"}),e.jsx("input",{type:"number",min:"1",value:y.quantity,onChange:N=>v(O(T({},y),{quantity:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Qty"}),e.jsxs("select",{value:y.type,onChange:N=>v(O(T({},y),{type:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[e.jsx("option",{value:"stem",children:"Stem"}),e.jsx("option",{value:"vase",children:"Vase"}),e.jsx("option",{value:"accessory",children:"Accessory"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("input",{type:"text",value:y.notes,onChange:N=>v(O(T({},y),{notes:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Notes (optional)"}),e.jsx("button",{onClick:R,className:"bg-emerald-600 text-white px-4 py-2 rounded-md hover:bg-emerald-700 transition-colors",children:"Add"})]}),x.ingredients.length>0&&e.jsx("div",{className:"space-y-2",children:x.ingredients.map((N,D)=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-md border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium",children:N.name}),e.jsxs("span",{className:"text-gray-500",children:["x",N.quantity]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ce(N.type)}`,children:N.type}),N.notes&&e.jsxs("span",{className:"text-sm text-gray-500",children:["(",N.notes,")"]})]}),e.jsx("button",{onClick:()=>L(D),className:"text-red-500 hover:text-red-700",children:e.jsx(Ze,{className:"w-4 h-4"})})]},D))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ee,className:"bg-emerald-600 text-white px-6 py-2 rounded-md hover:bg-emerald-700 transition-colors",children:"Save Recipe"}),e.jsx("button",{onClick:()=>l(!1),className:"bg-gray-500 text-white px-6 py-2 rounded-md hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}),c&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 mb-6 border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Edit Arrangement Recipe"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Arrangement Name *"}),e.jsx("input",{type:"text",value:m.name,onChange:N=>w(O(T({},m),{name:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Spring Garden Bouquet"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website Price ($)"}),e.jsx("input",{type:"number",step:"0.01",value:m.websitePrice,onChange:N=>w(O(T({},m),{websitePrice:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),e.jsx("textarea",{value:m.description,onChange:N=>w(O(T({},m),{description:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Brief description of the arrangement..."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website URL (Optional)"}),e.jsx("input",{type:"url",value:m.websiteUrl,onChange:N=>w(O(T({},m),{websiteUrl:N.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://yourwebsite.com/arrangements/spring-garden"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Photo (Optional)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Upload Photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:ge,className:"hidden"})]}),m.photo&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:m.photo,alt:"Recipe preview",className:"w-16 h-16 object-cover rounded-md"}),e.jsx("button",{onClick:()=>w(O(T({},m),{photo:""})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:""})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Recipe Ingredients"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 mb-3",children:[e.jsx("input",{type:"text",value:C.name,onChange:N=>_(O(T({},C),{name:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingredient name"}),e.jsx("input",{type:"number",min:"1",value:C.quantity,onChange:N=>_(O(T({},C),{quantity:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Qty"}),e.jsxs("select",{value:C.type,onChange:N=>_(O(T({},C),{type:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"stem",children:"Stem"}),e.jsx("option",{value:"vase",children:"Vase"}),e.jsx("option",{value:"accessory",children:"Accessory"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("input",{type:"text",value:C.notes,onChange:N=>_(O(T({},C),{notes:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Notes (optional)"}),e.jsx("button",{onClick:le,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Add"})]}),m.ingredients.length>0&&e.jsx("div",{className:"space-y-2",children:m.ingredients.map((N,D)=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-md border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium",children:N.name}),e.jsxs("span",{className:"text-gray-500",children:["x",N.quantity]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ce(N.type)}`,children:N.type}),N.notes&&e.jsxs("span",{className:"text-sm text-gray-500",children:["(",N.notes,")"]})]}),e.jsx("button",{onClick:()=>ke(D),className:"text-red-500 hover:text-red-700",children:e.jsx(Ze,{className:"w-4 h-4"})})]},D))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:me,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(ns,{className:"w-4 h-4"}),"Save Changes"]}),e.jsxs("button",{onClick:be,className:"bg-gray-500 text-white px-6 py-2 rounded-md hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx(pt,{className:"w-4 h-4"}),"Cancel"]})]})]}),a.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Vt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No arrangement recipes yet. Add your first recipe to start analyzing costs."})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:a.map(N=>{const D=E(N);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:N.name}),N.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:N.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Website: $",N.websitePrice.toFixed(2)]}),e.jsxs("span",{children:[N.ingredients.length," ingredients"]}),N.websiteUrl&&e.jsxs("a",{href:N.websiteUrl,target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:text-emerald-700 flex items-center gap-1",children:[e.jsx(ia,{className:"w-3 h-3"}),"View"]})]})]}),N.photo&&e.jsx("img",{src:N.photo,alt:N.name,className:"w-20 h-20 object-cover rounded-md ml-4"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsxs("h4",{className:"font-medium text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Cost Analysis"]}),D.canCalculate?e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Your Wholesale:"}),e.jsxs("div",{className:"font-medium",children:["$",D.totalWholesale.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Your Retail:"}),e.jsxs("div",{className:"font-medium text-green-600",children:["$",D.totalRetail.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Your Profit:"}),e.jsxs("div",{className:"font-medium text-blue-600",children:["$",D.profit.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Website Profit:"}),e.jsxs("div",{className:`font-medium ${D.websiteProfit>=0?"text-green-600":"text-red-600"}`,children:["$",D.websiteProfit.toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"Profit Difference:"}),e.jsxs("div",{className:`font-bold ${D.profitDifference>=0?"text-green-600":"text-red-600"}`,children:["$",D.profitDifference>=0?"+":"","$",D.profitDifference.toFixed(2),D.profitDifference>=0?" (Website pays more)":" (Your price is better)"]})]})]}):e.jsxs("div",{className:"text-amber-600 text-sm",children:[e.jsx("p",{className:"mb-2",children:" Missing price data for:"}),e.jsx("ul",{className:"list-disc list-inside",children:D.missingItems.map((p,f)=>e.jsx("li",{children:p},f))}),e.jsx("p",{className:"mt-2 text-xs text-gray-600",children:"Add these items to your product library to calculate costs."})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Ingredients"}),e.jsx("div",{className:"space-y-1",children:N.ingredients.map((p,f)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:p.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ce(p.type)}`,children:p.type}),p.notes&&e.jsxs("span",{className:"text-gray-500",children:["(",p.notes,")"]})]}),e.jsxs("span",{className:"text-gray-600",children:["x",p.quantity]})]},f))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Updated: ",N.lastUpdated.toLocaleDateString()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Q(N),className:"text-blue-600 hover:text-blue-700 text-sm flex items-center gap-1",children:[e.jsx(Ks,{className:"w-3 h-3"}),"Edit"]}),e.jsxs("button",{onClick:()=>u(N),className:"text-emerald-600 hover:text-emerald-700 text-sm flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3"}),"Analyze"]}),e.jsxs("button",{onClick:()=>n(N.id),className:"text-red-500 hover:text-red-700 text-sm flex items-center gap-1",children:[e.jsx(Ze,{className:"w-3 h-3"}),"Delete"]})]})]})]},N.id)})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:d.name}),e.jsx("p",{className:"text-gray-600",children:"Detailed Cost Analysis"})]}),e.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx("span",{className:"text-2xl",children:""})})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ot,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Detailed analysis view coming soon..."})]})]})})})]})},So=({orders:a})=>{const t=S.useMemo(()=>{if(a.length===0)return null;const r=a.reduce((y,v)=>y+v.totalRetail,0),n=a.reduce((y,v)=>y+v.totalWholesale,0),i=r-n,o=r>0?i/r*100:0,l=r/a.length,c=new Map;a.forEach(y=>{y.products.forEach(v=>{const C=`${v.name}-${v.type}`,_=c.get(C)||{name:v.name,type:v.type,totalQuantity:0,totalRevenue:0,totalCost:0,totalProfit:0,orderCount:0},E=v.wholesaleCost*v.quantity,R=E*2.5;_.totalQuantity+=v.quantity,_.totalCost+=E,_.totalRevenue+=R,_.totalProfit+=R-E,_.orderCount+=1,c.set(C,_)})});const h=Array.from(c.values()).sort((y,v)=>v.totalProfit-y.totalProfit).slice(0,10),d=Array.from(c.values()).sort((y,v)=>v.totalQuantity-y.totalQuantity).slice(0,5),u=new Map,x=new Date;x.setMonth(x.getMonth()-6),a.filter(y=>y.date>=x).forEach(y=>{const v=y.date.toLocaleDateString("en-US",{year:"numeric",month:"short"}),C=u.get(v)||{month:v,revenue:0,profit:0,orderCount:0};C.revenue+=y.totalRetail,C.profit+=y.profit,C.orderCount+=1,u.set(v,C)});const b=Array.from(u.values()).sort((y,v)=>new Date(y.month).getTime()-new Date(v.month).getTime()),m=a.reduce((y,v)=>v.profit>y.profit?v:y),w=a.reduce((y,v)=>v.profit<y.profit?v:y);return{totalRevenue:r,totalCosts:n,totalProfit:i,avgProfitMargin:o,avgOrderValue:l,topProducts:h,topByQuantity:d,monthlyTrends:b,bestOrder:m,worstOrder:w,totalOrders:a.length}},[a]);if(!t)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ue,{className:"w-5 h-5 text-green-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Profit Analytics"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No orders yet. Save some orders to see profit analytics."})]})]});const s=r=>{switch(r){case"stem":return"bg-green-100 text-green-800";case"vase":return"bg-blue-100 text-blue-800";case"accessory":return"bg-purple-100 text-purple-800";case"other":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(ue,{className:"w-5 h-5 text-green-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Profit Analytics"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",t.totalOrders," orders analyzed)"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-full",children:e.jsx(Ie,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Total Revenue"}),e.jsxs("div",{className:"text-2xl font-bold text-green-700",children:["$",t.totalRevenue.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(ue,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Profit"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:["$",t.totalProfit.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-blue-600",children:[t.avgProfitMargin.toFixed(1),"% margin"]})]})]})}),e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-purple-100 p-2 rounded-full",children:e.jsx(He,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Avg Order Value"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:["$",t.avgOrderValue.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx(gt,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Total Orders"}),e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:t.totalOrders})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600"}),"Top Profit Makers"]}),e.jsx("div",{className:"space-y-3",children:t.topProducts.slice(0,5).map((r,n)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-yellow-100 rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold text-yellow-700",children:n+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s(r.type)}`,children:r.type}),e.jsxs("span",{className:"text-xs text-gray-500",children:[r.totalQuantity," sold in ",r.orderCount," orders"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-green-600",children:["$",r.totalProfit.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["$",r.totalRevenue.toFixed(2)," revenue"]})]})]},`${r.name}-${r.type}`))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-blue-600"}),"Most Popular Items"]}),e.jsx("div",{className:"space-y-3",children:t.topByQuantity.map((r,n)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold text-blue-700",children:n+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:r.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s(r.type)}`,children:r.type})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-blue-600",children:r.totalQuantity}),e.jsxs("div",{className:"text-xs text-gray-500",children:[r.orderCount," orders"]})]})]},`${r.name}-${r.type}`))})]})]}),t.monthlyTrends.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(gt,{className:"w-5 h-5 text-indigo-600"}),"Monthly Trends (Last 6 Months)"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:t.monthlyTrends.map(r=>e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:r.month}),e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["$",r.profit.toFixed(0)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[r.orderCount," orders"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["$",r.revenue.toFixed(0)," revenue"]})]},r.month))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5 text-green-600"}),"Most Profitable Order"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium text-gray-800",children:t.bestOrder.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.bestOrder.date.toLocaleDateString()}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",t.bestOrder.profit.toFixed(2)," profit"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["$",t.bestOrder.totalRetail.toFixed(2)," revenue  ",t.bestOrder.products.length," items"]})]})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Gt,{className:"w-5 h-5 text-red-600"}),"Lowest Profit Order"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium text-gray-800",children:t.worstOrder.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.worstOrder.date.toLocaleDateString()}),e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["$",t.worstOrder.profit.toFixed(2)," profit"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["$",t.worstOrder.totalRetail.toFixed(2)," revenue  ",t.worstOrder.products.length," items"]})]})]})]})]})},Co=({orders:a})=>{if(a.length===0)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ae,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Business Insights"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ae,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Save some orders to unlock powerful business insights and recommendations."})]})]});const t=a.reduce((d,u)=>d+u.totalRetail,0),s=a.reduce((d,u)=>d+u.totalWholesale,0),r=t>0?(t-s)/t*100:0,n=t/a.length,i=a.filter(d=>(d.totalRetail>0?d.profit/d.totalRetail*100:0)<40),o=new Map;a.forEach(d=>{d.products.forEach(u=>{const x=`${u.name}-${u.type}`,b=o.get(x)||{profit:0,quantity:0,orders:0},m=u.wholesaleCost*1.5*u.quantity;b.profit+=m,b.quantity+=u.quantity,b.orders+=1,o.set(x,b)})});const l=Array.from(o.entries()).map(([d,u])=>T({name:d},u)).sort((d,u)=>u.profit-d.profit).slice(0,5),c=a.filter(d=>{const u=new Date;return u.setDate(u.getDate()-30),d.date>=u}),h=[{type:"success",icon:st,title:"Strong Performance",message:`Your average profit margin of ${r.toFixed(1)}% is ${r>50?"excellent":r>40?"good":"needs improvement"}`,action:r<40?"Consider reviewing your markup settings":null},{type:i.length>a.length*.3?"warning":"info",icon:Hs,title:"Pricing Opportunities",message:`${i.length} of ${a.length} orders had margins below 40%`,action:i.length>0?"Review these orders for pricing optimization":null},{type:"info",icon:ue,title:"Order Trends",message:`${c.length} orders in the last 30 days, averaging $${n.toFixed(2)} per order`,action:c.length<10?"Focus on increasing order frequency":null}];return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ae,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Business Insights"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",a.length," orders analyzed)"]})]}),e.jsx("div",{className:"space-y-4 mb-8",children:h.map((d,u)=>{const x=d.icon,b={success:"bg-green-50 border-green-200 text-green-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"};return e.jsx("div",{className:`border rounded-lg p-4 ${b[d.type]}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{className:"w-5 h-5 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium mb-1",children:d.title}),e.jsx("p",{className:"text-sm mb-2",children:d.message}),d.action&&e.jsxs("p",{className:"text-xs font-medium",children:[" ",d.action]})]})]})},u)})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600"}),"Top Performing Products"]}),e.jsx("div",{className:"space-y-3",children:l.map((d,u)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-yellow-100 rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold text-yellow-700",children:u+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:d.name.split("-")[0]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[d.quantity," sold in ",d.orders," orders"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-green-600",children:["$",d.profit.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"estimated profit"})]})]},d.name))})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-indigo-600"}),"Recommendations"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600",children:""}),e.jsx("span",{children:"Use Staff Training Mode during busy seasons to maintain consistent margins"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600",children:""}),e.jsx("span",{children:"Focus on promoting your top-performing products for higher profits"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600",children:""}),e.jsx("span",{children:"Review low-margin orders to identify pricing improvement opportunities"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600",children:""}),e.jsx("span",{children:"Create arrangement recipes for your most profitable combinations"})]})]})]})]})},Po=({products:a,markupSettings:t,targetBudget:s=100,userRole:r="staff"})=>{const[n,i]=S.useState(s),[o,l]=S.useState(!1),c=a.reduce((_,E)=>_+E.wholesaleCost*E.quantity,0),h=a.reduce((_,E)=>{const R=t[E.type],L=E.wholesaleCost*R;return _+L*E.quantity},0),d=h-c,x=n-c<0,b=h>0?d/h*100:0,m=n-h,w=m<0,v=(()=>w?{color:"text-red-600",bg:"bg-red-50",icon:Gt}:m<n*.1?{color:"text-yellow-600",bg:"bg-yellow-50",icon:Gt}:{color:"text-green-600",bg:"bg-green-50",icon:re})(),C=v.icon;return a.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ye,{className:"w-5 h-5 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Staff Training Mode"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Perfect for training seasonal staff! Add products to see real-time budget tracking."})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Staff Training Mode"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Target Budget:"}),e.jsx("input",{type:"number",value:n,onChange:_=>i(parseFloat(_.target.value)||0),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("button",{onClick:()=>l(!o),className:"text-sm text-purple-600 hover:text-purple-700",children:[o?"Hide":"Show"," Profit Details"]})]})]}),e.jsx("div",{className:`${v.bg} border border-opacity-20 rounded-lg p-4 mb-6`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:`w-6 h-6 ${v.color}`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`font-semibold ${v.color}`,children:w?"Over Budget!":m<n*.1?"Budget Warning":"Within Budget"}),e.jsxs("div",{className:`text-2xl font-bold ${v.color}`,children:["$",Math.abs(m).toFixed(2)," ",w?"over":"remaining"]})]}),e.jsx("p",{className:`text-sm ${v.color} mt-1`,children:w?"Remove items or increase budget to stay profitable":m<n*.1?"Close to budget limit - be careful with additional items":"Good! You have room for more items if needed"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx(Ae,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Target Budget"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:["$",n.toFixed(2)]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[e.jsx(Ie,{className:"w-8 h-8 text-gray-600 mx-auto mb-2"}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Current Order Cost"}),e.jsxs("div",{className:"text-2xl font-bold text-gray-700",children:["$",h.toFixed(2)]})]}),e.jsxs("div",{className:`${v.bg} rounded-lg p-4 text-center`,children:[e.jsx(C,{className:`w-8 h-8 ${v.color} mx-auto mb-2`}),e.jsx("div",{className:`text-sm ${v.color} font-medium`,children:"Status"}),e.jsx("div",{className:`text-2xl font-bold ${v.color}`,children:w?"OVER":"OK"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:"Budget Usage"}),e.jsxs("span",{children:[(h/n*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${x?"bg-red-500":h/n>.9?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(h/n*100,100)}%`}})})]}),o&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"}),"Profit Analysis (Manager View)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Wholesale Cost:"}),e.jsxs("div",{className:"font-medium",children:["$",c.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Retail Price:"}),e.jsxs("div",{className:"font-medium text-green-600",children:["$",h.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Profit:"}),e.jsxs("div",{className:"font-bold text-green-700",children:["$",d.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Margin:"}),e.jsxs("div",{className:"font-bold text-blue-600",children:[b.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsxs("h4",{className:"font-medium text-purple-800 mb-2",children:[" ",r==="staff"?"Your Guidelines":"Staff Instructions"]}),e.jsxs("ul",{className:"text-sm text-purple-700 space-y-1",children:[e.jsx("li",{children:' Keep the "Current Order Cost" under the "Target Budget"'}),e.jsx("li",{children:" Green status = Good to go! You can add more items"}),e.jsx("li",{children:" Yellow status = Getting close, be careful"}),e.jsx("li",{children:" Red status = Over budget! Remove items or ask manager"}),e.jsxs("li",{children:[" ",r==="staff"?"Focus on creating beautiful arrangements within budget":"Train staff to focus on beautiful arrangements within budget"]})]})]})]})},To=({posSettings:a,onUpdateSettings:t})=>{const[s,r]=S.useState(a);S.useEffect(()=>{console.log("POSConfiguration: Parent posSettings changed:",a),r(a)},[a]);const n=()=>{if(!s.storeName.trim()){alert("Please enter a store name before saving.");return}const i={storeName:s.storeName.trim(),isConfigured:!0};console.log("POSConfiguration: Saving settings to localStorage:",i),t(i),r(i),alert("Store settings saved successfully!")};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(is,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Store Configuration"}),s.isConfigured&&e.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full",children:"CONFIGURED"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-3",children:"Store Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-1",children:"Store/Business Name *"}),e.jsx("input",{type:"text",value:s.storeName,onChange:i=>r(O(T({},s),{storeName:i.target.value})),className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Bloom & Blossom Florist",required:!0})]})})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-green-800 mb-3",children:"How Staff Orders Work"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"FlowerCost Pro uses a simple copy/paste system that works with any POS system. No technical setup or integrations required."}),e.jsxs("div",{className:"bg-green-100 border border-green-200 rounded-md p-3",children:[e.jsx("p",{className:"text-sm text-green-800 mb-2",children:e.jsx("strong",{children:"Simple 4-Step Process:"})}),e.jsxs("ol",{className:"text-sm text-green-700 list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Staff creates arrangement in FlowerCost Pro"}),e.jsx("li",{children:"System generates formatted order details with staff name"}),e.jsx("li",{children:'Staff clicks "Copy Order Details" button'}),e.jsx("li",{children:"Staff pastes details into your POS system and processes payment"})]})]}),e.jsx("div",{className:"mt-3 p-3 bg-green-100 border border-green-200 rounded-md",children:e.jsxs("p",{className:"text-xs text-green-700",children:[e.jsx("strong",{children:" Benefits:"})," Works with Square, Clover, Toast, Shopify POS, or any system  No monthly integration fees  Staff names tracked  Instant setup"]})})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:n,disabled:!s.storeName,className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ns,{className:"w-4 h-4"}),"Save Store Settings"]})}),s.isConfigured&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Current Configuration"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Store:"})," ",s.storeName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Integration:"})," Manual Copy/Paste (Universal)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{className:"text-green-600 font-medium ml-1",children:"Ready for Staff Use"})]})]})]})]})]})},Oo=({orders:a})=>{const[t,s]=S.useState(null),[r,n]=S.useState(""),[i,o]=S.useState(!1),l=a.filter(m=>m.name.toLowerCase().includes(r.toLowerCase())),c=m=>{s(m),o(!1),n("")},h=()=>{s(null)},d=m=>{const w=[];return w.push("=".repeat(50)),w.push(`ORDER: ${m.name}`),w.push(`DATE: ${m.date.toLocaleDateString()} ${m.date.toLocaleTimeString()}`),w.push(`ORDER ID: #${m.id}`),m.staffName&&w.push(`STAFF: ${m.staffName}${m.staffId?` (ID: ${m.staffId})`:""}`),w.push("=".repeat(50)),w.push(""),m.notes&&(w.push("NOTES:"),w.push(m.notes),w.push("")),w.push("ITEMS:"),w.push("-".repeat(50)),m.products.forEach((y,v)=>{const C=y.wholesaleCost*2.5,_=y.wholesaleCost*y.quantity,E=C*y.quantity,R=E-_;w.push(`${v+1}. ${y.name} (${y.type})`),w.push(`   Qty: ${y.quantity} | Wholesale: $${y.wholesaleCost.toFixed(2)} each`),w.push(`   Retail: $${C.toFixed(2)} each | Total: $${E.toFixed(2)}`),w.push(`   Item Profit: $${R.toFixed(2)}`),w.push("")}),w.push("-".repeat(50)),w.push("FINANCIAL SUMMARY:"),w.push(`Total Items: ${m.products.reduce((y,v)=>y+v.quantity,0)}`),w.push(`Total Wholesale Cost: $${m.totalWholesale.toFixed(2)}`),w.push(`Total Retail Price: $${m.totalRetail.toFixed(2)}`),w.push(`Total Profit: $${m.profit.toFixed(2)}`),w.push(`Profit Margin: ${(m.profit/m.totalRetail*100).toFixed(1)}%`),w.push("=".repeat(50)),w.join(`
`)},u=()=>g(W,null,function*(){if(!t)return;const m=d(t);try{yield navigator.clipboard.writeText(m),alert("Order details copied to clipboard! You can now paste this into your POS system.")}catch(w){const y=document.createElement("textarea");y.value=m,document.body.appendChild(y),y.select(),document.execCommand("copy"),document.body.removeChild(y),alert("Order details copied to clipboard! You can now paste this into your POS system.")}}),x=()=>{if(!t)return;const m=d(t),w=new Blob([m],{type:"text/plain"}),y=URL.createObjectURL(w),v=document.createElement("a");v.href=y,v.download=`${t.name.replace(/[^a-z0-9]/gi,"_")}_order_record.txt`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(y)},b=m=>{switch(m){case"stem":return"bg-green-100 text-green-800";case"vase":return"bg-blue-100 text-blue-800";case"accessory":return"bg-purple-100 text-purple-800";case"other":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ws,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"POS Order View"})]}),t&&e.jsxs("button",{onClick:h,className:"text-gray-500 hover:text-gray-700 flex items-center gap-1 text-sm",children:[e.jsx(pt,{className:"w-4 h-4"}),"Clear"]})]}),t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Order Date: ",t.date.toLocaleDateString()," at ",t.date.toLocaleTimeString()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Order ID: #",t.id]}),t.staffName&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Staff: ",t.staffName,t.staffId&&` (ID: ${t.staffId})`]})]}),t.photo&&e.jsx("div",{className:"ml-6",children:e.jsx("img",{src:t.photo,alt:t.name,className:"w-32 h-32 object-cover rounded-lg shadow-md"})})]}),t.notes&&e.jsxs("div",{className:"bg-white rounded-md p-3 mt-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:"Order Notes"}),e.jsx("p",{className:"text-gray-600 text-sm",children:t.notes})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-red-100 p-2 rounded-full",children:e.jsx(Ie,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Total Wholesale Cost"}),e.jsxs("div",{className:"text-2xl font-bold text-red-700",children:["$",t.totalWholesale.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-full",children:e.jsx(He,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Total Retail Price"}),e.jsxs("div",{className:"text-2xl font-bold text-green-700",children:["$",t.totalRetail.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(ue,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Profit"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:["$",t.profit.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-blue-600",children:[(t.profit/t.totalRetail*100).toFixed(1),"% margin"]})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Order Items (",t.products.length," items)"]}),e.jsx("div",{className:"space-y-3",children:t.products.map((m,w)=>{const y=m.wholesaleCost*2.5,v=m.wholesaleCost*m.quantity,C=y*m.quantity,_=C-v;return e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 rounded-full w-8 h-8 flex items-center justify-center text-sm font-medium text-gray-600",children:m.quantity}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-800",children:m.name}),e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${b(m.type)}`,children:m.type})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-green-600",children:["$",C.toFixed(2)]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["$",y.toFixed(2)," each"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm bg-gray-50 rounded-md p-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Wholesale:"}),e.jsxs("div",{className:"font-medium",children:["$",v.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Retail:"}),e.jsxs("div",{className:"font-medium text-green-600",children:["$",C.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Profit:"}),e.jsxs("div",{className:"font-medium text-blue-600",children:["$",_.toFixed(2)]})]})]})]},w)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 pt-4 border-t",children:[e.jsxs("button",{onClick:u,className:"bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ht,{className:"w-4 h-4"}),"Copy for POS"]}),e.jsxs("button",{onClick:x,className:"bg-orange-600 text-white py-2 px-4 rounded-md hover:bg-orange-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(ha,{className:"w-4 h-4"}),"Download Text"]}),e.jsxs("button",{onClick:()=>window.print(),className:"bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(ws,{className:"w-4 h-4"}),"Print Receipt"]}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(At,{className:"w-4 h-4"}),"Load Different Order"]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx(At,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"Upload Saved Order"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Select a saved order to view in POS format"}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-indigo-600 text-white px-6 py-2 rounded-md hover:bg-indigo-700 transition-colors flex items-center gap-2 mx-auto",children:[e.jsx(At,{className:"w-4 h-4"}),"Select Order"]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Select Order to Upload"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(pt,{className:"w-5 h-5"})})]}),e.jsx("input",{type:"text",value:r,onChange:m=>n(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Search orders..."})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-96",children:l.length>0?e.jsx("div",{className:"space-y-3",children:l.map(m=>e.jsx("div",{onClick:()=>c(m),className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:m.name}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[m.date.toLocaleDateString(),"  ",m.products.length," items"]}),e.jsxs("div",{className:"text-sm text-green-600 font-medium",children:["$",m.totalRetail.toFixed(2),"  Profit: $",m.profit.toFixed(2)]})]}),m.photo&&e.jsx("img",{src:m.photo,alt:m.name,className:"w-12 h-12 object-cover rounded-md ml-3"})]})},m.id))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No orders found"})})})]})})]})]})},Eo=[{id:"template-1",name:"Red Roses",wholesaleCost:3.5,type:"stem",lastUsed:"2024-01-15T10:30:00.000Z"},{id:"template-2",name:"White Roses",wholesaleCost:3.75,type:"stem",lastUsed:"2024-01-14T14:20:00.000Z"},{id:"template-3",name:"Baby's Breath",wholesaleCost:2.25,type:"stem",lastUsed:"2024-01-16T09:15:00.000Z"},{id:"template-4",name:"Eucalyptus",wholesaleCost:1.8,type:"stem",lastUsed:"2024-01-13T16:45:00.000Z"},{id:"template-5",name:"Glass Cylinder Vase",wholesaleCost:8.5,type:"vase",lastUsed:"2024-01-15T11:00:00.000Z"},{id:"template-6",name:"Ceramic Pot",wholesaleCost:12,type:"vase",lastUsed:"2024-01-12T13:30:00.000Z"},{id:"template-7",name:"Satin Ribbon",wholesaleCost:1.25,type:"accessory",lastUsed:"2024-01-16T15:20:00.000Z"},{id:"template-8",name:"Floral Foam",wholesaleCost:2.5,type:"other",lastUsed:"2024-01-14T08:45:00.000Z"},{id:"template-9",name:"Pink Carnations",wholesaleCost:2.1,type:"stem",lastUsed:"2024-01-15T12:15:00.000Z"},{id:"template-10",name:"Sunflowers",wholesaleCost:4.25,type:"stem",lastUsed:"2024-01-16T10:30:00.000Z"}],$o={stem:2.5,vase:2,accessory:3,other:2},Ao=[{id:"order-1",name:"Valentine's Day Bouquet - Johnson",date:"2024-01-15T14:30:00.000Z",products:[{id:"product-1",name:"Red Roses",wholesaleCost:3.5,quantity:12,type:"stem"},{id:"product-2",name:"Baby's Breath",wholesaleCost:2.25,quantity:3,type:"stem"},{id:"product-3",name:"Glass Cylinder Vase",wholesaleCost:8.5,quantity:1,type:"vase"},{id:"product-4",name:"Satin Ribbon",wholesaleCost:1.25,quantity:1,type:"accessory"}],totalWholesale:59.25,totalRetail:127.5,profit:68.25,notes:"Customer requested deep red roses, extra full arrangement"},{id:"order-2",name:"Sympathy Arrangement - Williams",date:"2024-01-14T09:15:00.000Z",products:[{id:"product-5",name:"White Roses",wholesaleCost:3.75,quantity:8,type:"stem"},{id:"product-6",name:"Eucalyptus",wholesaleCost:1.8,quantity:5,type:"stem"},{id:"product-7",name:"Ceramic Pot",wholesaleCost:12,quantity:1,type:"vase"},{id:"product-8",name:"Floral Foam",wholesaleCost:2.5,quantity:1,type:"other"}],totalWholesale:53.5,totalRetail:113.5,profit:60,notes:"Delivered to funeral home, white and green theme"},{id:"order-3",name:"Birthday Centerpiece - Davis",date:"2024-01-16T11:45:00.000Z",products:[{id:"product-9",name:"Sunflowers",wholesaleCost:4.25,quantity:6,type:"stem"},{id:"product-10",name:"Pink Carnations",wholesaleCost:2.1,quantity:8,type:"stem"},{id:"product-11",name:"Glass Cylinder Vase",wholesaleCost:8.5,quantity:1,type:"vase"}],totalWholesale:50.3,totalRetail:104.25,profit:53.95,notes:"Bright and cheerful for 50th birthday party"}],Ro=[{id:"recipe-1",name:"Classic Rose Bouquet",description:"Elegant dozen red roses with baby's breath and greenery",websitePrice:89.99,ingredients:[{name:"Red Roses",quantity:12,type:"stem",notes:"Premium grade"},{name:"Baby's Breath",quantity:3,type:"stem"},{name:"Eucalyptus",quantity:2,type:"stem"},{name:"Satin Ribbon",quantity:1,type:"accessory"}],lastUpdated:"2024-01-15T16:00:00.000Z",websiteUrl:"https://yourflowershop.com/classic-rose-bouquet"},{id:"recipe-2",name:"Sunny Day Arrangement",description:"Bright sunflowers with colorful carnations in ceramic pot",websitePrice:65.99,ingredients:[{name:"Sunflowers",quantity:4,type:"stem"},{name:"Pink Carnations",quantity:6,type:"stem"},{name:"Ceramic Pot",quantity:1,type:"vase"},{name:"Floral Foam",quantity:1,type:"other"}],lastUpdated:"2024-01-16T12:30:00.000Z"},{id:"recipe-3",name:"Peaceful Memories",description:"Serene white roses with eucalyptus in elegant vase",websitePrice:75.99,ingredients:[{name:"White Roses",quantity:8,type:"stem"},{name:"Eucalyptus",quantity:4,type:"stem"},{name:"Glass Cylinder Vase",quantity:1,type:"vase"}],lastUpdated:"2024-01-14T14:15:00.000Z",websiteUrl:"https://yourflowershop.com/peaceful-memories"}],Io="2024-01-17T10:00:00.000Z",Do="1.0",Oe={templates:Eo,markupSettings:$o,savedOrders:Ao,arrangementRecipes:Ro,exportDate:Io,version:Do},Uo=a=>{const[t,s]=S.useState(null),[r,n]=S.useState([]),[i,o]=S.useState({stem:2.5,vase:2,accessory:3,other:2}),[l,c]=S.useState([]),[h,d]=S.useState([]),[u,x]=S.useState({storeName:"",isConfigured:!1}),[b,m]=S.useState(!0),[w,y]=S.useState(null),v=()=>g(W,null,function*(){if(a)try{const{data:p,error:f}=yield V.from("profiles").select("*").eq("id",a).single();if(f)throw f;s(p)}catch(p){console.error("Error loading profile:",p),y(p.message)}}),C=()=>g(W,null,function*(){if(a)try{const{data:p,error:f}=yield V.from("product_templates").select("*").eq("user_id",a).order("last_used",{ascending:!1});if(f)throw f;const j=p.map(P=>({id:P.id,name:P.name,wholesaleCost:Number(P.wholesale_cost),type:P.type,lastUsed:new Date(P.last_used)}));n(j)}catch(p){console.error("Error loading product templates:",p),y(p.message)}}),_=()=>g(W,null,function*(){if(a)try{const{data:p,error:f}=yield V.from("markup_settings").select("*").eq("user_id",a).maybeSingle();if(f){if(f.code==="PGRST116"||!p){o({stem:2.5,vase:2,accessory:3,other:2});return}throw f}p&&o({stem:Number(p.stem),vase:Number(p.vase),accessory:Number(p.accessory),other:Number(p.other)})}catch(p){console.error("Error loading markup settings:",p),y(p.message)}}),E=()=>g(W,null,function*(){if(a)try{const{data:p,error:f}=yield V.from("orders").select(`
          *,
          order_products (*)
        `).eq("user_id",a).order("created_at",{ascending:!1});if(f)throw f;const j=p.map(P=>({id:P.id,name:P.name,date:new Date(P.created_at),products:P.order_products.map(B=>({id:B.id,name:B.name,wholesaleCost:Number(B.wholesale_cost),quantity:B.quantity,type:B.type})),totalWholesale:Number(P.total_wholesale),totalRetail:Number(P.total_retail),profit:Number(P.profit),photo:P.photo||void 0,notes:P.notes||void 0,staffName:P.staff_name||void 0,staffId:P.staff_id||void 0}));c(j)}catch(p){console.error("Error loading saved orders:",p),y(p.message)}}),R=()=>g(W,null,function*(){if(a)try{const{data:p,error:f}=yield V.from("arrangement_recipes").select(`
          *,
          recipe_ingredients (*)
        `).eq("user_id",a).order("updated_at",{ascending:!1});if(f)throw f;const j=p.map(P=>({id:P.id,name:P.name,description:P.description||void 0,websitePrice:Number(P.website_price),websiteUrl:P.website_url||void 0,photo:P.photo||void 0,ingredients:P.recipe_ingredients.map(B=>({name:B.name,quantity:B.quantity,type:B.type,notes:B.notes||void 0})),lastUpdated:new Date(P.updated_at)}));d(j)}catch(p){console.error("Error loading arrangement recipes:",p),y(p.message)}}),L=()=>g(W,null,function*(){if(a)try{const{data:p,error:f}=yield V.from("pos_settings").select("*").eq("user_id",a).maybeSingle();if(f){if(f.code==="PGRST116"||!p){x({storeName:"",isConfigured:!1});return}throw f}p&&x({storeName:p.store_name,isConfigured:p.is_configured})}catch(p){console.error("Error loading POS settings:",p),y(p.message)}}),A=()=>g(W,null,function*(){if(!a){console.log("Demo mode: Loading sample data...");try{const p=localStorage.getItem("demo_product_templates");if(p){const f=JSON.parse(p);n(f.map(j=>O(T({},j),{lastUsed:new Date(j.lastUsed)}))),console.log("Demo mode: Loaded product templates from localStorage:",f.length)}else n(Oe.templates.map(f=>O(T({},f),{lastUsed:new Date(f.lastUsed)}))),console.log("Demo mode: Using default product templates from sample data")}catch(p){console.error("Error loading demo product templates from localStorage:",p),n(Oe.templates.map(f=>O(T({},f),{lastUsed:new Date(f.lastUsed)})))}try{const p=localStorage.getItem("demo_markup_settings");if(p){const f=JSON.parse(p);o(f),console.log("Demo mode: Loaded markup settings from localStorage:",f)}else o(Oe.markupSettings),console.log("Demo mode: Using default markup settings from sample data")}catch(p){console.error("Error loading demo markup settings from localStorage:",p),o(Oe.markupSettings)}try{const p=localStorage.getItem("demo_saved_orders");if(p){const f=JSON.parse(p);c(f.map(j=>O(T({},j),{date:new Date(j.date),products:j.products.map(P=>O(T({},P),{wholesaleCost:Number(P.wholesaleCost)}))}))),console.log("Demo mode: Loaded saved orders from localStorage:",f.length)}else c(Oe.savedOrders.map(f=>O(T({},f),{date:new Date(f.date),products:f.products.map(j=>O(T({},j),{wholesaleCost:Number(j.wholesaleCost)}))}))),console.log("Demo mode: Using default saved orders from sample data")}catch(p){console.error("Error loading demo saved orders from localStorage:",p),c(Oe.savedOrders.map(f=>O(T({},f),{date:new Date(f.date),products:f.products.map(j=>O(T({},j),{wholesaleCost:Number(j.wholesaleCost)}))})))}d(Oe.arrangementRecipes.map(p=>O(T({},p),{lastUpdated:new Date(p.lastUpdated),websitePrice:Number(p.websitePrice)})));try{const p=localStorage.getItem("demo_pos_settings");if(p){const f=JSON.parse(p);x(f),console.log("Demo mode: Loaded POS settings from localStorage:",f)}}catch(p){console.error("Error loading demo POS settings from localStorage:",p)}m(!1);return}m(!0),y(null);try{yield Promise.all([v(),C(),_(),E(),R(),L()])}catch(p){console.error("Error loading data:",p),y(p.message)}finally{m(!1)}}),ee=p=>g(W,null,function*(){if(!a){const f={id:`demo-${Date.now()}`,name:p.name,wholesaleCost:p.wholesaleCost,type:p.type,lastUsed:p.lastUsed};n(j=>[f,...j]);try{const j=[f,...r];localStorage.setItem("demo_product_templates",JSON.stringify(j)),console.log("Demo mode: Product templates saved to localStorage")}catch(j){console.error("Error saving product templates to localStorage:",j)}return f}try{const{data:f,error:j}=yield V.from("product_templates").insert({user_id:a,name:p.name,wholesale_cost:p.wholesaleCost,type:p.type,last_used:p.lastUsed.toISOString()}).select().single();if(j)throw j;const P={id:f.id,name:f.name,wholesaleCost:Number(f.wholesale_cost),type:f.type,lastUsed:new Date(f.last_used)};return n(B=>[P,...B]),P}catch(f){throw console.error("Error saving product template:",f),f}}),Q=(p,f)=>g(W,null,function*(){if(!a){n(j=>j.map(P=>P.id===p?T(T({},P),f):P));try{const j=r.map(P=>P.id===p?T(T({},P),f):P);localStorage.setItem("demo_product_templates",JSON.stringify(j)),console.log("Demo mode: Product templates updated in localStorage")}catch(j){console.error("Error updating product templates in localStorage:",j)}return}try{const j={};f.name&&(j.name=f.name),f.wholesaleCost!==void 0&&(j.wholesale_cost=f.wholesaleCost),f.type&&(j.type=f.type),f.lastUsed&&(j.last_used=f.lastUsed.toISOString());const{error:P}=yield V.from("product_templates").update(j).eq("id",p).eq("user_id",a);if(P)throw P;n(B=>B.map(z=>z.id===p?T(T({},z),f):z))}catch(j){throw console.error("Error updating product template:",j),j}}),me=p=>g(W,null,function*(){if(!a){const f=r.filter(j=>j.id!==p);n(f);try{localStorage.setItem("demo_product_templates",JSON.stringify(f)),console.log("Demo mode: Product template deleted from localStorage")}catch(j){console.error("Error deleting product template from localStorage:",j)}return}try{const{error:f}=yield V.from("product_templates").delete().eq("id",p).eq("user_id",a);if(f)throw f;n(j=>j.filter(P=>P.id!==p))}catch(f){throw console.error("Error deleting product template:",f),f}}),be=p=>g(W,null,function*(){if(!a){console.log("Demo mode: Saving markup settings to local state:",p),o(p);try{localStorage.setItem("demo_markup_settings",JSON.stringify(p)),console.log("Demo mode: Markup settings saved to localStorage successfully")}catch(f){console.error("Error saving markup settings to localStorage:",f)}return}try{const{error:f}=yield V.from("markup_settings").upsert({user_id:a,stem:p.stem,vase:p.vase,accessory:p.accessory,other:p.other});if(f)throw f;o(p)}catch(f){throw console.error("Error saving markup settings:",f),f}}),le=p=>g(W,null,function*(){if(!a){const f=O(T({},p),{id:`demo-order-${Date.now()}`,date:new Date});console.log("Demo mode: Saving order to local state:",f),c(j=>[f,...j]),console.log("Demo mode: Order saved successfully");try{const j=[f,...l];localStorage.setItem("demo_saved_orders",JSON.stringify(j)),console.log("Demo mode: Saved orders updated in localStorage")}catch(j){console.error("Error saving orders to localStorage:",j)}return f}try{const{data:f,error:j}=yield V.from("orders").insert({user_id:a,name:p.name,total_wholesale:p.totalWholesale,total_retail:p.totalRetail,profit:p.profit,photo:p.photo,notes:p.notes,staff_name:p.staffName,staff_id:p.staffId}).select().single();if(j)throw j;const P=p.products.map(G=>({order_id:f.id,name:G.name,wholesale_cost:G.wholesaleCost,quantity:G.quantity,type:G.type})),{error:B}=yield V.from("order_products").insert(P);if(B)throw B;const z=O(T({},p),{id:f.id,date:new Date(f.created_at)});return c(G=>[z,...G]),z}catch(f){throw console.error("Error saving order:",f),f}}),ke=p=>g(W,null,function*(){if(!a){const f=l.filter(j=>j.id!==p);c(f);try{localStorage.setItem("demo_saved_orders",JSON.stringify(f)),console.log("Demo mode: Order deleted from localStorage")}catch(j){console.error("Error deleting order from localStorage:",j)}return}try{const{error:f}=yield V.from("orders").delete().eq("id",p).eq("user_id",a);if(f)throw f;c(j=>j.filter(P=>P.id!==p))}catch(f){throw console.error("Error deleting order:",f),f}}),ge=p=>g(W,null,function*(){if(a)try{const{data:f,error:j}=yield V.from("arrangement_recipes").insert({user_id:a,name:p.name,description:p.description,website_price:p.websitePrice,website_url:p.websiteUrl,photo:p.photo}).select().single();if(j)throw j;const P=p.ingredients.map(G=>({recipe_id:f.id,name:G.name,quantity:G.quantity,type:G.type,notes:G.notes})),{error:B}=yield V.from("recipe_ingredients").insert(P);if(B)throw B;const z=O(T({},p),{id:f.id,lastUpdated:new Date(f.updated_at)});return d(G=>[z,...G]),z}catch(f){throw console.error("Error saving arrangement recipe:",f),f}}),ce=(p,f)=>g(W,null,function*(){if(a)try{const j={};f.name&&(j.name=f.name),f.description!==void 0&&(j.description=f.description),f.websitePrice!==void 0&&(j.website_price=f.websitePrice),f.websiteUrl!==void 0&&(j.website_url=f.websiteUrl),f.photo!==void 0&&(j.photo=f.photo);const{error:P}=yield V.from("arrangement_recipes").update(j).eq("id",p).eq("user_id",a);if(P)throw P;if(f.ingredients){const{error:B}=yield V.from("recipe_ingredients").delete().eq("recipe_id",p);if(B)throw B;const z=f.ingredients.map(te=>({recipe_id:p,name:te.name,quantity:te.quantity,type:te.type,notes:te.notes})),{error:G}=yield V.from("recipe_ingredients").insert(z);if(G)throw G}d(B=>B.map(z=>z.id===p?O(T(T({},z),f),{lastUpdated:new Date}):z))}catch(j){throw console.error("Error updating arrangement recipe:",j),j}}),N=p=>g(W,null,function*(){if(a)try{const{error:f}=yield V.from("arrangement_recipes").delete().eq("id",p).eq("user_id",a);if(f)throw f;d(j=>j.filter(P=>P.id!==p))}catch(f){throw console.error("Error deleting arrangement recipe:",f),f}}),D=p=>g(W,null,function*(){if(!a){console.log("Demo mode: Saving POS settings to local state:",p),x(p);try{localStorage.setItem("demo_pos_settings",JSON.stringify(p)),console.log("Demo mode: POS settings saved to localStorage successfully")}catch(f){console.error("Error saving to localStorage:",f)}return}try{const{error:f}=yield V.from("pos_settings").upsert({user_id:a,store_name:p.storeName,is_configured:p.isConfigured});if(f)throw f;x(p),console.log("Authenticated mode: POS settings saved to Supabase successfully")}catch(f){throw console.error("Error saving POS settings:",f),f}});return S.useEffect(()=>{if(!a)try{const p=localStorage.getItem("demo_pos_settings");if(p){const j=JSON.parse(p);x(j),console.log("Demo mode: Loaded POS settings from localStorage:",j)}const f=localStorage.getItem("demo_markup_settings");if(f){const j=JSON.parse(f);o(j),console.log("Demo mode: Loaded markup settings from localStorage:",j)}}catch(p){console.error("Error loading demo settings from localStorage:",p)}A()},[a]),{profile:t,productTemplates:r,markupSettings:i,savedOrders:l,arrangementRecipes:h,posSettings:u,loading:b,error:w,saveProductTemplate:ee,updateProductTemplate:Q,deleteProductTemplate:me,saveMarkupSettings:be,saveOrder:le,deleteOrder:ke,saveArrangementRecipe:ge,updateArrangementRecipe:ce,deleteArrangementRecipe:N,savePosSettings:D,loadAllData:A}},Bs=({onClose:a})=>{const[t,s]=S.useState(""),[r,n]=S.useState(""),[i,o]=S.useState(!1),l=c=>g(W,null,function*(){if(c.preventDefault(),!t.trim()||!r.trim()){alert("Please fill in both email and feedback fields.");return}o(!0);try{const{error:h}=yield V.from("beta_feedback").insert({email:t.trim().toLowerCase(),feedback:r.trim(),timestamp:new Date().toISOString()});if(h)throw h;alert("Thank you for your feedback! We really appreciate it."),a()}catch(h){console.error("Feedback submission error:",h),alert("There was an error submitting your feedback. Please try again.")}finally{o(!1)}});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Share Your Feedback"}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Email"}),e.jsx("input",{type:"email",value:t,onChange:c=>s(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"your@email.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Feedback"}),e.jsx("textarea",{value:r,onChange:c=>n(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"What do you think about FlowerCost Pro? Any suggestions or issues?",required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:i?"Submitting...":"Submit Feedback"}),e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})};function Bt({error:a,resetErrorBoundary:t}){return e.jsx("div",{className:"min-h-screen bg-red-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"We're sorry, but there was an error loading the application."}),e.jsx("button",{onClick:t,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Try again"})]})})}function Lo(){var Ue;const[a,t]=S.useState("landing"),[s,r]=S.useState(null),[n,i]=S.useState("owner"),[o,l]=S.useState("overview"),[c,h]=S.useState(!1),[d,u]=S.useState(!1),[x,b]=S.useState([]),{profile:m,productTemplates:w,markupSettings:y,savedOrders:v,arrangementRecipes:C,posSettings:_,loading:E,error:R,saveProductTemplate:L,updateProductTemplate:A,deleteProductTemplate:ee,saveMarkupSettings:Q,saveOrder:me,deleteOrder:be,saveArrangementRecipe:le,updateArrangementRecipe:ke,deleteArrangementRecipe:ge,savePosSettings:ce}=Uo((s==null?void 0:s.id)||null);S.useEffect(()=>{(()=>g(this,null,function*(){try{const{user:ne}=yield go();ne&&(r(ne),t("dashboard"))}catch(ne){console.error("Error checking user:",ne)}}))();const{data:{subscription:ve}}=V.auth.onAuthStateChange((ne,Le)=>g(this,null,function*(){ne==="SIGNED_IN"&&(Le!=null&&Le.user)?(r(Le.user),t("dashboard")):ne==="SIGNED_OUT"?(r(null),t("landing")):ne==="PASSWORD_RECOVERY"&&(h(!0),t("auth"))}));return()=>ve.unsubscribe()},[]);const N=()=>{console.log("App: handleStartDemo called"),console.log("App: Setting currentView to dashboard and user to demo"),r({id:null,email:"demo@flowercostpro.com"}),t("dashboard"),i("owner"),l("overview"),console.log("App: Demo mode activated")},D=()=>{t("auth"),h(!1)},p=()=>{t("dashboard"),h(!1)},f=()=>{t("landing"),h(!1)},j=()=>g(this,null,function*(){try{yield V.auth.signOut(),r(null),t("landing"),l("overview"),i("owner")}catch(de){console.error("Logout error:",de)}}),P=()=>{console.log("App: handleShowFeedback called"),u(!0)},B=de=>g(this,null,function*(){try{const ve={name:de.name,wholesaleCost:de.wholesaleCost,type:de.type,lastUsed:new Date};yield L(ve)}catch(ve){console.error("Error adding product:",ve),alert("Error adding product. Please try again.")}}),z=de=>{b(de)},G=((Ue=s==null?void 0:s.user_metadata)==null?void 0:Ue.full_name)||(m==null?void 0:m.full_name)||(s?"User":"Demo User"),te=(m==null?void 0:m.store_name)||(_==null?void 0:_.storeName)||"Demo Flower Shop";if(a==="landing")return e.jsxs(Pt,{FallbackComponent:Bt,children:[e.jsx(fo,{onStartDemo:N,onSignIn:D,onShowFeedback:P}),d&&e.jsx(Bs,{onClose:()=>u(!1)})]});if(a==="auth")return e.jsx(Pt,{FallbackComponent:Bt,children:e.jsx(po,{onAuthSuccess:p,isPasswordReset:c,onBackToLanding:f})});if(E)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})});if(R)return e.jsx("div",{className:"min-h-screen bg-red-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Error Loading Data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:R}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Page"})]})});const Se=()=>{switch(o){case"create-order":return e.jsx(vo,{templates:w,recipes:C,markupSettings:y,onSaveOrder:me,onOrderChange:z,userRole:n,posSettings:_});case"products":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(jo,{onAddProduct:B}),e.jsx(wo,{templates:w,markupSettings:y,onUpdateTemplate:A,onDeleteTemplate:ee})]});case"recipes":return e.jsx(ko,{recipes:C,templates:w,markupSettings:y,onSaveRecipe:le,onDeleteRecipe:ge,onUpdateRecipe:ke});case"orders":return e.jsx(_o,{orders:v,onDeleteOrder:be});case"analytics":return e.jsx(So,{orders:v});case"insights":return e.jsx(Co,{orders:v,templates:w});case"settings":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(No,{markupSettings:y,onMarkupChange:Q}),e.jsx(To,{posSettings:_,onUpdateSettings:ce})]});case"staff-training":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Po,{products:x,markupSettings:y,targetBudget:100,userRole:n}),e.jsx(Oo,{orders:v})]});default:return null}};return e.jsxs(Pt,{FallbackComponent:Bt,children:[e.jsx(xo,{userRole:n,userName:G,storeName:te,onRoleChange:i,activeSection:o,onSectionChange:l,onLogout:j,onShowFeedback:P,children:e.jsx(yo,{activeSection:o,userRole:n,orders:v,templates:w,children:Se()})}),d&&e.jsx(Bs,{onClose:()=>u(!1)})]})}Wt.createRoot(document.getElementById("root")).render(e.jsx(Sr.StrictMode,{children:e.jsx(Lo,{})}))});export default Fo();
